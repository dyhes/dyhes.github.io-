<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Hint 非功能需求及其含义\n产品为了满足用户的业务需求而必须具备的除功能之外的特性，它与功能需求是互补的\n性能 可扩展性/伸缩性 可维护性 可用性 安全性 业务质量(cost, schedule, staff, resources) 编程的三个层次\n面向过程 面向对象 面向事件 面向对象设计的三大原则（特性）\n封装\n就是将客观事物抽象为逻辑实体，实体的属性和功能相结合，形成一个有机的整体。并对实体的属性和功能实现进行访问控制，向信任的实体开放，对不信任的实体隐藏。，通过开放的外部接口即可访问，无需知道功能如何实现。\n继承\n在继承机制下形成有层级的类，使得低层级的类可以延用高层级类的特征和方法\n多态\n是指一个类的同名方法，在不同情况下的实现细节不同\nDesign Pattern 作用 可重用性 容易被他人理解 代码可靠性 原则 开闭原则（Open Closed Principle，OCP）\n对扩展开放，对修改关闭\n单一职责原则（Single Responsibility Principle, SRP）\n一个类只负责一个功能领域中的相应职责\n依赖倒转原则（Dependency Inversion Principle，DIP）\n依赖于抽象，不能依赖于具体实现\n里氏代换原则（Liskov Substitution Principle，LSP）\n所有引用基类的地方必须能透明地使用其子类的对象\n接口隔离原则（Interface Segregation Principle，ISP）\n类之间的依赖关系应该建立在最小的接口上\n合成/聚合复用原则（Composite/Aggregate Reuse Principle，CARP）\n尽量使用合成/聚合，而不是通过继承达到复用的目的\n最少知识原则（Least Knowledge Principle，LKP）或者迪米特法则（Law of Demeter，LOD）\n一个软件实体应当尽可能少的与其他实体发生相互作用\n创建型模式 关注点是如何创建对象，其核心思想是要把对象的创建和使用相分离，这样使得两者能相对独立地变换\nSingleton 单例\n提供访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象。\nabstract\nobject Singleton { ... } implementation\n"><title>【设计模式】笔记</title>
<link rel=canonical href=https://dyhes.github.io/p/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0/><link rel=stylesheet href=/scss/style.min.6aa4d43a5cae1c51ef34b3f851ae7421f4b2f2d13827e2d975acbeb4f13c8710.css><meta property='og:title' content="【设计模式】笔记"><meta property='og:description' content="Hint 非功能需求及其含义\n产品为了满足用户的业务需求而必须具备的除功能之外的特性，它与功能需求是互补的\n性能 可扩展性/伸缩性 可维护性 可用性 安全性 业务质量(cost, schedule, staff, resources) 编程的三个层次\n面向过程 面向对象 面向事件 面向对象设计的三大原则（特性）\n封装\n就是将客观事物抽象为逻辑实体，实体的属性和功能相结合，形成一个有机的整体。并对实体的属性和功能实现进行访问控制，向信任的实体开放，对不信任的实体隐藏。，通过开放的外部接口即可访问，无需知道功能如何实现。\n继承\n在继承机制下形成有层级的类，使得低层级的类可以延用高层级类的特征和方法\n多态\n是指一个类的同名方法，在不同情况下的实现细节不同\nDesign Pattern 作用 可重用性 容易被他人理解 代码可靠性 原则 开闭原则（Open Closed Principle，OCP）\n对扩展开放，对修改关闭\n单一职责原则（Single Responsibility Principle, SRP）\n一个类只负责一个功能领域中的相应职责\n依赖倒转原则（Dependency Inversion Principle，DIP）\n依赖于抽象，不能依赖于具体实现\n里氏代换原则（Liskov Substitution Principle，LSP）\n所有引用基类的地方必须能透明地使用其子类的对象\n接口隔离原则（Interface Segregation Principle，ISP）\n类之间的依赖关系应该建立在最小的接口上\n合成/聚合复用原则（Composite/Aggregate Reuse Principle，CARP）\n尽量使用合成/聚合，而不是通过继承达到复用的目的\n最少知识原则（Least Knowledge Principle，LKP）或者迪米特法则（Law of Demeter，LOD）\n一个软件实体应当尽可能少的与其他实体发生相互作用\n创建型模式 关注点是如何创建对象，其核心思想是要把对象的创建和使用相分离，这样使得两者能相对独立地变换\nSingleton 单例\n提供访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象。\nabstract\nobject Singleton { ... } implementation\n"><meta property='og:url' content='https://dyhes.github.io/p/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0/'><meta property='og:site_name' content='飞鸿踏雪泥'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2023-06-06T00:00:00+00:00'><meta property='article:modified_time' content='2023-06-06T00:00:00+00:00'><meta name=twitter:title content="【设计模式】笔记"><meta name=twitter:description content="Hint 非功能需求及其含义\n产品为了满足用户的业务需求而必须具备的除功能之外的特性，它与功能需求是互补的\n性能 可扩展性/伸缩性 可维护性 可用性 安全性 业务质量(cost, schedule, staff, resources) 编程的三个层次\n面向过程 面向对象 面向事件 面向对象设计的三大原则（特性）\n封装\n就是将客观事物抽象为逻辑实体，实体的属性和功能相结合，形成一个有机的整体。并对实体的属性和功能实现进行访问控制，向信任的实体开放，对不信任的实体隐藏。，通过开放的外部接口即可访问，无需知道功能如何实现。\n继承\n在继承机制下形成有层级的类，使得低层级的类可以延用高层级类的特征和方法\n多态\n是指一个类的同名方法，在不同情况下的实现细节不同\nDesign Pattern 作用 可重用性 容易被他人理解 代码可靠性 原则 开闭原则（Open Closed Principle，OCP）\n对扩展开放，对修改关闭\n单一职责原则（Single Responsibility Principle, SRP）\n一个类只负责一个功能领域中的相应职责\n依赖倒转原则（Dependency Inversion Principle，DIP）\n依赖于抽象，不能依赖于具体实现\n里氏代换原则（Liskov Substitution Principle，LSP）\n所有引用基类的地方必须能透明地使用其子类的对象\n接口隔离原则（Interface Segregation Principle，ISP）\n类之间的依赖关系应该建立在最小的接口上\n合成/聚合复用原则（Composite/Aggregate Reuse Principle，CARP）\n尽量使用合成/聚合，而不是通过继承达到复用的目的\n最少知识原则（Least Knowledge Principle，LKP）或者迪米特法则（Law of Demeter，LOD）\n一个软件实体应当尽可能少的与其他实体发生相互作用\n创建型模式 关注点是如何创建对象，其核心思想是要把对象的创建和使用相分离，这样使得两者能相对独立地变换\nSingleton 单例\n提供访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象。\nabstract\nobject Singleton { ... } implementation\n"><link rel="shortcut icon" href=/github.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu17834253352308399148.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>飞鸿踏雪泥</a></h1><h2 class=site-description>没有记录，就没有发生</h2></div></header><ol class=menu-social><li><a href=https://github.com/dyhes target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:dyheslin@gmail.com target=_blank title=Gmail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-gmail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16 20h3a1 1 0 001-1V5a1 1 0 00-1-1h-3v16z"/><path d="M5 20h3V4H5A1 1 0 004 5v14a1 1 0 001 1z"/><path d="M16 4l-4 4-4-4"/><path d="M4 6.5l8 7.5 8-7.5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/categories/><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#hint>Hint</a></li><li><a href=#design-pattern>Design Pattern</a><ol><li><a href=#作用>作用</a></li><li><a href=#原则>原则</a></li><li><a href=#创建型模式>创建型模式</a><ol><li><a href=#singleton>Singleton</a></li><li><a href=#factory>Factory</a></li><li><a href=#应该不考>应该不考</a></li></ol></li><li><a href=#行为型模式>行为型模式</a><ol><li><a href=#observer-vs-mvc时序图vs-reactor时序图>Observer vs. MVC（时序图）vs. Reactor（时序图）</a></li><li><a href=#interpreter>Interpreter</a></li><li><a href=#strategy>Strategy</a></li><li><a href=#visitor>Visitor</a></li><li><a href=#应该不考-1>应该不考</a></li></ol></li><li><a href=#结构型模式>结构型模式</a><ol><li><a href=#adapter>Adapter</a></li><li><a href=#proxy>Proxy</a></li><li><a href=#decorator>Decorator</a></li><li><a href=#应该不考-2>应该不考</a></li></ol></li><li><a href=#design-pattern-in-power-point>Design Pattern in Power Point</a></li></ol></li><li><a href=#software-architecture>Software architecture</a><ol><li><a href=#管道过滤器风格><strong>管道过滤器风格</strong></a></li><li><a href=#主程序子程序风格><strong>主程序/子程序风格</strong></a></li><li><a href=#面向对象风格><strong>面向对象风格</strong></a></li><li><a href=#分层的风格><strong>分层的风格</strong></a></li><li><a href=#基于共享数据的事件风格><strong>基于共享数据的事件风格</strong></a></li><li><a href=#powerpoint>PowerPoint</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/star/ style=background-color:#2e317c;color:>一天星</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0/>【设计模式】笔记</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 06, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>15 minute read</time></div></footer></div></header><section class=article-content><h2 id=hint>Hint</h2><p><strong>非功能需求及其含义</strong></p><p>产品为了满足用户的业务需求而必须具备的除功能之外的特性，它与功能需求是互补的</p><ul><li>性能</li><li>可扩展性/伸缩性</li><li>可维护性</li><li>可用性</li><li>安全性</li><li>业务质量(cost, schedule, staff, resources)</li></ul><p><strong>编程的三个层次</strong></p><ul><li>面向过程</li><li>面向对象</li><li>面向事件</li></ul><p><strong>面向对象设计的三大原则（特性）</strong></p><ol><li><p>封装</p><p>就是将客观事物抽象为逻辑实体，实体的属性和功能相结合，形成一个有机的整体。并<strong>对实体的属性和功能实现进行访问控制</strong>，向信任的实体开放，对不信任的实体隐藏。，<strong>通过开放的外部接口即可访问</strong>，无需知道功能如何实现。</p></li><li><p>继承</p><p>在继承机制下形成有层级的类，使得低层级的类可以延用高层级类的特征和方法</p></li><li><p>多态</p><p>是指一个类的同名方法，在不同情况下的实现细节不同</p></li></ol><h2 id=design-pattern>Design Pattern</h2><h3 id=作用>作用</h3><ul><li>可重用性</li><li>容易被他人理解</li><li>代码可靠性</li></ul><h3 id=原则>原则</h3><ul><li><p>开闭原则（Open Closed Principle，OCP）</p><p>对扩展开放，对修改关闭</p></li><li><p>单一职责原则（Single Responsibility Principle, SRP）</p><p>一个类只负责一个功能领域中的相应职责</p></li><li><p>依赖倒转原则（Dependency Inversion Principle，DIP）</p><p>依赖于抽象，不能依赖于具体实现</p></li><li><p>里氏代换原则（Liskov Substitution Principle，LSP）</p><p>所有引用基类的地方必须能透明地使用其子类的对象</p></li><li><p>接口隔离原则（Interface Segregation Principle，ISP）</p><p>类之间的依赖关系应该建立在最小的接口上</p></li><li><p>合成/聚合复用原则（Composite/Aggregate Reuse Principle，CARP）</p><p>尽量使用合成/聚合，而不是通过继承达到复用的目的</p></li><li><p>最少知识原则（Least Knowledge Principle，LKP）或者迪米特法则（Law of Demeter，LOD）</p><p>一个软件实体应当尽可能少的与其他实体发生相互作用</p></li></ul><h3 id=创建型模式>创建型模式</h3><p>关注点是如何创建对象，其核心思想是要<strong>把对象的创建和使用相分离</strong>，这样使得两者能相对独立地变换</p><h4 id=singleton>Singleton</h4><p>单例</p><p>提供访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>object</span><span class=w> </span><span class=n>Singleton</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>object</span> <span class=nc>Singleton</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>service</span><span class=p>():</span> <span class=n>Unit</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I am singleton&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I offer some general service&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>demo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Singleton</span><span class=p>.</span><span class=n>service</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=factory>Factory</h4><p>工厂</p><p>不对外暴露创建逻辑，并且是通过使用一个共同的接口来指向新创建的对象。</p><h5 id=simple-factory>Simple Factory</h5><p>一个Factory返回多个Product子类，新增Product子类时需修改Factory类</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>ProductType</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>OrganismType</span><span class=p>:</span> <span class=n>ProductType</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>AQUATIC</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>TERRESTRIAL</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Aquatic</span><span class=p>:</span> <span class=n>Organism</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Terrestrial</span><span class=p>:</span> <span class=n>Organism</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//水生生物与陆生生物
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>object</span> <span class=nc>OrganismFactory</span><span class=p>:</span> <span class=n>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Organism</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=n>productType</span> <span class=k>as</span> <span class=n>OrganismType</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>when</span> <span class=p>(</span><span class=n>productType</span> <span class=k>as</span> <span class=n>OrganismType</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nc>OrganismType</span><span class=p>.</span><span class=n>AQUATIC</span> <span class=o>-&gt;</span> <span class=n>Aquatic</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nc>OrganismType</span><span class=p>.</span><span class=n>TERRESTRIAL</span> <span class=o>-&gt;</span> <span class=n>Terrestrial</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>simpleFactoryDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>organism</span> <span class=p>=</span> <span class=nc>OrganismFactory</span><span class=p>.</span><span class=n>getProduct</span><span class=p>(</span><span class=nc>OrganismType</span><span class=p>.</span><span class=n>TERRESTRIAL</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=factory-method>Factory Method</h5><p>每个Product子类均有各自对应的Factory</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>ProductType</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Organism</span><span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>OrganismFactories</span><span class=p>:</span> <span class=n>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Organism</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Aquatic</span><span class=p>:</span> <span class=n>Organism</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Terrestrial</span><span class=p>:</span> <span class=n>Organism</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>OrganismType</span><span class=p>:</span> <span class=n>ProductType</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>AQUATIC</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>TERRESTRIAL</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>object</span> <span class=nc>AquaticFactory</span><span class=p>:</span> <span class=n>OrganismFactories</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Organism</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>productType</span> <span class=k>as</span> <span class=n>OrganismType</span> <span class=o>!=</span> <span class=nc>OrganismType</span><span class=p>.</span><span class=n>AQUATIC</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>(</span><span class=s2>&#34;wrong type&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;aquatic&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Aquatic</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>object</span> <span class=nc>TerrestrialFactory</span><span class=p>:</span> <span class=n>OrganismFactories</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Organism</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>productType</span> <span class=k>as</span> <span class=n>OrganismType</span> <span class=o>!=</span> <span class=nc>OrganismType</span><span class=p>.</span><span class=n>TERRESTRIAL</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>(</span><span class=s2>&#34;wrong type&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;terrestrial&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Terrestrial</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>OrganismType</span><span class=p>:</span> <span class=n>ProductType</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>AQUATIC</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>TERRESTRIAL</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>factoryMethodDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>aquatic</span> <span class=p>=</span> <span class=nc>AquaticFactory</span><span class=p>.</span><span class=n>getProduct</span><span class=p>(</span><span class=nc>OrganismType</span><span class=p>.</span><span class=n>AQUATIC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>terrestrial</span> <span class=p>=</span> <span class=nc>AquaticFactory</span><span class=p>.</span><span class=n>getProduct</span><span class=p>(</span><span class=nc>OrganismType</span><span class=p>.</span><span class=n>TERRESTRIAL</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=abstract-factory>Abstract Factory</h5><p>抽象工厂</p><p>工厂方法的进一步深化，围绕一个超级工厂创建其他工厂。该超级工厂又称为其他工厂的工厂</p><p>当存在多个Product族时使用，类似于简单工厂与工厂方法的结合，从Product族层面看为工厂方法，从某一Product族中的子Product层面看为简单工厂</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>ProductType</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>ProductFamilyType</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>AbstractFactory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productFamilyType</span><span class=p>:</span> <span class=n>ProductFamilyType</span><span class=p>,</span> <span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Substance</span><span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Organic</span><span class=p>:</span> <span class=n>Substance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Inorganic</span><span class=p>:</span> <span class=n>Substance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>SubstanceType</span><span class=p>:</span> <span class=n>ProductType</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>SubstanceFamilyType</span><span class=p>:</span> <span class=n>ProductFamilyType</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ORGANIC</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>INORGANIC</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>OrganicType</span><span class=p>:</span> <span class=n>SubstanceType</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FAT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>PROTEIN</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>CARBOHYDRATE</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>InorganicType</span><span class=p>:</span> <span class=n>SubstanceType</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>WATER</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>INORGANICSALT</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Water</span><span class=p>:</span> <span class=n>Inorganic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>InorganicSalt</span><span class=p>:</span> <span class=n>Inorganic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Fat</span><span class=p>:</span> <span class=n>Organic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Protein</span><span class=p>:</span> <span class=n>Organic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Carbohydrate</span><span class=p>:</span> <span class=n>Organic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//有机物与无机物
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>object</span> <span class=nc>InorganicFactory</span><span class=p>:</span> <span class=n>AbstractFactory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productFamilyType</span><span class=p>:</span> <span class=n>ProductFamilyType</span><span class=p>,</span> <span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Inorganic</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>productFamilyType</span> <span class=k>as</span> <span class=n>SubstanceFamilyType</span><span class=o>!=</span><span class=nc>SubstanceFamilyType</span><span class=p>.</span><span class=n>INORGANIC</span><span class=p>)</span> <span class=k>throw</span> <span class=n>java</span><span class=p>.</span><span class=n>lang</span><span class=p>.</span><span class=n>Exception</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>val</span> <span class=py>substance</span> <span class=p>=</span> <span class=k>when</span> <span class=p>(</span><span class=n>productType</span> <span class=k>as</span> <span class=n>InorganicType</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nc>InorganicType</span><span class=p>.</span><span class=n>WATER</span> <span class=o>-&gt;</span> <span class=n>Water</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nc>InorganicType</span><span class=p>.</span><span class=n>INORGANICSALT</span> <span class=o>-&gt;</span> <span class=n>InorganicSalt</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$productType</span><span class=s2> of </span><span class=si>$productFamilyType</span><span class=s2> family is produced&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>substance</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>object</span> <span class=nc>OrganicFactory</span><span class=p>:</span> <span class=n>AbstractFactory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>getProduct</span><span class=p>(</span><span class=n>productFamilyType</span><span class=p>:</span> <span class=n>ProductFamilyType</span><span class=p>,</span> <span class=n>productType</span><span class=p>:</span> <span class=n>ProductType</span><span class=p>):</span> <span class=n>Organic</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>productFamilyType</span> <span class=k>as</span> <span class=n>SubstanceFamilyType</span><span class=o>!=</span><span class=nc>SubstanceFamilyType</span><span class=p>.</span><span class=n>ORGANIC</span><span class=p>)</span> <span class=k>throw</span> <span class=n>java</span><span class=p>.</span><span class=n>lang</span><span class=p>.</span><span class=n>Exception</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>val</span> <span class=py>substance</span> <span class=p>=</span> <span class=k>when</span> <span class=p>(</span><span class=n>productType</span> <span class=k>as</span> <span class=n>OrganicType</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nc>OrganicType</span><span class=p>.</span><span class=n>FAT</span> <span class=o>-&gt;</span> <span class=n>Fat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nc>OrganicType</span><span class=p>.</span><span class=n>CARBOHYDRATE</span> <span class=o>-&gt;</span> <span class=n>Carbohydrate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nc>OrganicType</span><span class=p>.</span><span class=n>PROTEIN</span> <span class=o>-&gt;</span> <span class=n>Protein</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$productType</span><span class=s2> of </span><span class=si>$productFamilyType</span><span class=s2> family is produced&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>substance</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>abstractFactoryDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nc>OrganicFactory</span><span class=p>.</span><span class=n>getProduct</span><span class=p>(</span><span class=nc>SubstanceFamilyType</span><span class=p>.</span><span class=n>ORGANIC</span><span class=p>,</span><span class=nc>InorganicType</span><span class=p>.</span><span class=n>INORGANICSALT</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=n>e</span><span class=p>:</span> <span class=n>Exception</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;wrong productFamilyType or ProductType&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=应该不考>应该不考</h4><h5 id=builder>Builder</h5><p>建造者</p><p>建造者模式（Builder Pattern）使用多个简单的对象一步一步构建成一个复杂的对象，将一个复杂的构建与其表示相分离，使得同样的构建过程可以创建不同的表示。</p><p>适用于：</p><p>1、需要生成的对象具有复杂的内部结构。</p><p>2、需要生成的对象内部属性本身相互依赖。</p><blockquote><p>vs. Factory Pattern ：建造者模式更加关注与零件装配的顺序。</p><p>vs. Bridge Pattern</p></blockquote><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Builder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>build</span><span class=p>():</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>Intelligence</span><span class=p>(</span><span class=k>val</span> <span class=py>wisdom</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span><span class=p>)</span> <span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>Courage</span><span class=p>(</span><span class=k>val</span> <span class=py>courageous</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span><span class=p>)</span> <span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>Spirit</span><span class=p>(</span><span class=k>val</span> <span class=py>intelligence</span><span class=p>:</span> <span class=n>Intelligence</span> <span class=p>=</span> <span class=n>Intelligence</span><span class=p>(),</span> <span class=k>val</span> <span class=py>courage</span><span class=p>:</span> <span class=n>Courage</span> <span class=p>=</span> <span class=n>Courage</span><span class=p>())</span> <span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>Skelecton</span><span class=p>(</span><span class=k>val</span> <span class=py>solidity</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span><span class=p>)</span> <span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>Muscle</span><span class=p>(</span><span class=k>val</span> <span class=py>strength</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span><span class=p>)</span> <span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>Flesh</span><span class=p>(</span><span class=k>val</span> <span class=py>skelecton</span><span class=p>:</span> <span class=n>Skelecton</span> <span class=p>=</span> <span class=n>Skelecton</span><span class=p>(),</span> <span class=k>val</span> <span class=py>muscle</span><span class=p>:</span> <span class=n>Muscle</span> <span class=p>=</span> <span class=n>Muscle</span><span class=p>())</span> <span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>Life</span><span class=p>(</span><span class=k>val</span> <span class=py>spirit</span><span class=p>:</span> <span class=n>Spirit</span><span class=p>,</span> <span class=k>val</span> <span class=py>flesh</span><span class=p>:</span> <span class=n>Flesh</span><span class=p>)</span> <span class=p>:</span> <span class=n>Product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>LifeBuilder</span><span class=p>:</span> <span class=n>Builder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>var</span> <span class=py>spirit</span><span class=p>:</span> <span class=n>Spirit</span> <span class=p>=</span> <span class=n>Spirit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>var</span> <span class=py>flesh</span><span class=p>:</span> <span class=n>Flesh</span> <span class=p>=</span> <span class=n>Flesh</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>soul</span><span class=p>(</span><span class=n>wisdom</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span> <span class=n>courageous</span><span class=p>:</span> <span class=n>Int</span><span class=p>):</span> <span class=n>LifeBuilder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>spirit</span> <span class=p>=</span> <span class=n>Spirit</span><span class=p>(</span><span class=n>Intelligence</span><span class=p>(</span><span class=n>wisdom</span><span class=p>),</span> <span class=n>Courage</span><span class=p>(</span><span class=n>courageous</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;intelligence </span><span class=si>$wisdom</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;courageous </span><span class=si>$courageous</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;a beautiful soul was infused&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>this</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>body</span><span class=p>(</span><span class=n>solidity</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span> <span class=n>strength</span><span class=p>:</span> <span class=n>Int</span><span class=p>):</span> <span class=n>LifeBuilder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>flesh</span> <span class=p>=</span> <span class=n>Flesh</span><span class=p>(</span><span class=n>Skelecton</span><span class=p>(</span><span class=n>solidity</span><span class=p>),</span> <span class=n>Muscle</span><span class=p>(</span><span class=n>strength</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;solidity </span><span class=si>$solidity</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;strength </span><span class=si>$strength</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;a strong body is formed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>this</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>build</span><span class=p>():</span> <span class=n>Life</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;spirit is infused with flesh&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Life</span><span class=p>(</span><span class=n>spirit</span><span class=p>,</span><span class=n>flesh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=prototype>Prototype</h5><p>原型</p><p>用于创建重复的对象，利用已有的一个原型对象，通过<strong>复制</strong>快速地生成和原型对象一样的实例，同时又能保证性能，当直接创建对象的代价比较大时，则可采用这种模式。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Content</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>copy</span><span class=p>():</span> <span class=n>Content</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Prototype</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>Content</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>clone</span><span class=p>():</span> <span class=n>Content</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=c1>//仿生人
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>Android</span><span class=p>:</span> <span class=n>Content</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>copy</span><span class=p>():</span> <span class=n>Content</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;new android had been manufactured&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Android</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AndroidPrototype</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>Android</span><span class=p>)</span> <span class=p>:</span> <span class=n>Prototype</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>clone</span><span class=p>():</span> <span class=n>Content</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>content</span><span class=p>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>prototypeDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>androidPrototype</span> <span class=p>=</span> <span class=n>AndroidPrototype</span><span class=p>(</span><span class=n>Android</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>nAndroid</span><span class=p>:</span> <span class=n>Android</span> <span class=p>=</span> <span class=n>androidPrototype</span><span class=p>.</span><span class=n>clone</span><span class=p>()</span> <span class=k>as</span> <span class=n>Android</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=行为型模式>行为型模式</h3><p>主要涉及算法和对象间的职责分配，描述一组对象应该如何通过使用对象组合协作来完成一个整体任务。</p><h4 id=observer-vs-mvc时序图vs-reactor时序图>Observer vs. MVC（时序图）vs. Reactor（时序图）</h4><h5 id=observer>Observer</h5><p>观察者</p><p>当一个对象被修改时，自动通知依赖它的对象</p><blockquote><p>vs. Reactor</p></blockquote><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Observer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>update</span><span class=p>(</span><span class=n>observableState</span><span class=p>:</span> <span class=n>ObservableState</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>ObservableState</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Observable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>state</span><span class=p>:</span> <span class=n>ObservableState</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>observers</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Observer</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>attachObserver</span><span class=p>(</span><span class=n>observer</span><span class=p>:</span> <span class=n>Observer</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>observers</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>observer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>updateState</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>ObservableState</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>state</span> <span class=p>=</span> <span class=n>state</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>notifyObservers</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>observers</span><span class=p>.</span><span class=n>forEach</span> <span class=p>{</span> <span class=k>it</span> <span class=o>-&gt;</span> <span class=k>it</span><span class=p>.</span><span class=n>update</span><span class=p>(</span><span class=n>state</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>LoginState</span><span class=p>(</span><span class=k>val</span> <span class=py>on</span><span class=p>:</span> <span class=n>Boolean</span> <span class=p>=</span> <span class=k>false</span><span class=p>)</span> <span class=p>:</span> <span class=n>ObservableState</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=k>override</span> <span class=k>var</span> <span class=py>state</span><span class=p>:</span> <span class=n>ObservableState</span> <span class=p>=</span> <span class=n>LoginState</span><span class=p>(),</span> <span class=k>override</span> <span class=k>val</span> <span class=py>observers</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Observer</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>Observable</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Portrait</span><span class=p>:</span> <span class=n>Observer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>update</span><span class=p>(</span><span class=n>observableState</span><span class=p>:</span> <span class=n>ObservableState</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>when</span><span class=p>(</span> <span class=p>(</span><span class=n>observableState</span> <span class=k>as</span> <span class=n>LoginState</span><span class=p>).</span><span class=n>on</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>true</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;portrait became light&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>false</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;portrait become dark&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Friends</span><span class=p>:</span> <span class=n>Observer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>update</span><span class=p>(</span><span class=n>observableState</span><span class=p>:</span> <span class=n>ObservableState</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>when</span><span class=p>(</span> <span class=p>(</span><span class=n>observableState</span> <span class=k>as</span> <span class=n>LoginState</span><span class=p>).</span><span class=n>on</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>true</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;user is online&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>false</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;user is offline&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>observerDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>user</span> <span class=p>=</span> <span class=n>User</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span><span class=p>.</span><span class=n>attachObserver</span><span class=p>(</span><span class=n>Friends</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span><span class=p>.</span><span class=n>attachObserver</span><span class=p>(</span><span class=n>Portrait</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span><span class=p>.</span><span class=n>notifyObservers</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span><span class=p>.</span><span class=n>updateState</span><span class=p>(</span><span class=n>LoginState</span><span class=p>(</span><span class=k>true</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=reactor>Reactor</h5><p>基于<strong>事件驱动</strong>的设计模式，拥有一个或多个并发输入源，有一个服务处理器和多个请求处理器，服务处理器会同步的将输入的请求事件以多路复用的方式分发给相应的请求处理器</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Event</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Reactor</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>handlers</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>EventHandler</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>dispatch</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>EventHandler</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>handle</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>ClickedEvent</span><span class=p>:</span> <span class=n>Event</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EnteredEvent</span><span class=p>:</span> <span class=n>Event</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ClickedEventHandler</span><span class=p>:</span> <span class=n>EventHandler</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>handle</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;clicked event is handled&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EnteredEventHandler</span><span class=p>:</span> <span class=n>EventHandler</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>handle</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;entered event is handled&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventDispatcher</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>handlers</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>EventHandler</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>Reactor</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>dispatch</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>when</span> <span class=p>(</span><span class=n>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>ClickedEvent</span> <span class=o>-&gt;</span> <span class=n>ClickedEventHandler</span><span class=p>().</span><span class=n>handle</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>EnteredEvent</span> <span class=o>-&gt;</span> <span class=n>EnteredEventHandler</span><span class=p>().</span><span class=n>handle</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>reactorDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>eventDispatcher</span> <span class=p>=</span> <span class=n>EventDispatcher</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>eventDispatcher</span><span class=p>.</span><span class=n>dispatch</span><span class=p>(</span><span class=n>ClickedEvent</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>eventDispatcher</span><span class=p>.</span><span class=n>dispatch</span><span class=p>(</span><span class=n>EnteredEvent</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=mvc>MVC</h5><ul><li><strong>模型（Model）</strong> 用于封装与应用程序的业务逻辑相关的数据以及对数据的处理方法。“ Model ”有对数据直接访问的权力，例如对数据库的访问。“Model”不依赖“View”和“Controller”，也就是说， Model 不关心它会被如何显示或是如何被操作。但是 Model 中数据的变化一般会通过一种刷新机制被公布。为了实现这种机制， View 或事先在此 Model 上注册，从而，View 可以了解在数据 Model 上发生的改变（<a class=link href=https://zh.m.wikipedia.org/wiki/%e8%a7%82%e5%af%9f%e8%80%85%e6%a8%a1%e5%bc%8f target=_blank rel=noopener>观察者模式</a>）或在Controller操控下更新View</li><li>**视图（View）**能够实现数据有目的的显示（理论上，这不是必需的）。在 View 中一般没有程序上的逻辑。为了实现 View 上的刷新功能，View 需要访问它监视的数据模型（Model），因此应该事先在被它监视的数据那里注册。</li><li>**控制器（Controller）**起到不同层面间的组织作用，用于控制应用程序的流程。它处理事件并作出响应。“事件”包括用户的行为和数据 Model 上的改变。</li></ul><p><img src=https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/MVC-Process.svg/200px-MVC-Process.svg.png loading=lazy alt=img></p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Model</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>update</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>saveToDatabase</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>notifyView</span><span class=p>(</span><span class=n>view</span><span class=p>:</span> <span class=n>View</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Controller</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>model</span><span class=p>:</span> <span class=n>Model</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>view</span><span class=p>:</span> <span class=n>View</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>updateModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>View</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>updateGUI</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>ViewImpl</span><span class=p>:</span> <span class=n>View</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>updateGUI</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;gui is updated&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ControllerImpl</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>model</span><span class=p>:</span> <span class=n>Model</span> <span class=p>=</span> <span class=n>ModelImpl</span><span class=p>(),</span> <span class=k>override</span> <span class=k>val</span> <span class=py>view</span><span class=p>:</span> <span class=n>View</span> <span class=p>=</span> <span class=n>ViewImpl</span><span class=p>())</span> <span class=p>:</span> <span class=n>Controller</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>updateModel</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;controller react to user behavior&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=p>.</span><span class=n>update</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=p>.</span><span class=n>notifyView</span><span class=p>(</span><span class=n>view</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ModelImpl</span> <span class=p>:</span> <span class=n>Model</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>update</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;model is updated&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>saveToDatabase</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>saveToDatabase</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;change to model is saved to database&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>notifyView</span><span class=p>(</span><span class=n>view</span><span class=p>:</span> <span class=n>View</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;notify view&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>view</span><span class=p>.</span><span class=n>updateGUI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>MVCDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>controller</span> <span class=p>=</span> <span class=n>ControllerImpl</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>controller</span><span class=p>.</span><span class=n>updateModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=interpreter>Interpreter</h4><p>解释器</p><p>给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来解释语言中的句子</p><p>常被用在 SQL 解析、符号处理引擎</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Expression</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>String</span><span class=p>):</span> <span class=n>Boolean</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>AndExpression</span><span class=p>(</span><span class=k>val</span> <span class=py>exp1</span><span class=p>:</span> <span class=n>Expression</span><span class=p>,</span> <span class=k>val</span> <span class=py>exp2</span><span class=p>:</span> <span class=n>Expression</span><span class=p>):</span> <span class=n>Expression</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>String</span><span class=p>):</span> <span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>exp1</span><span class=p>.</span><span class=n>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>)</span><span class=o>&amp;&amp;</span><span class=n>exp2</span><span class=p>.</span><span class=n>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrExpression</span><span class=p>(</span><span class=k>val</span> <span class=py>exp1</span><span class=p>:</span> <span class=n>Expression</span><span class=p>,</span> <span class=k>val</span> <span class=py>exp2</span><span class=p>:</span> <span class=n>Expression</span><span class=p>):</span> <span class=n>Expression</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>String</span><span class=p>):</span> <span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>exp1</span><span class=p>.</span><span class=n>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>)</span><span class=o>||</span><span class=n>exp2</span><span class=p>.</span><span class=n>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>NotExpression</span><span class=p>(</span><span class=k>val</span> <span class=py>exp</span><span class=p>:</span> <span class=n>Expression</span><span class=p>):</span> <span class=n>Expression</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>String</span><span class=p>):</span> <span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>!</span><span class=n>exp</span><span class=p>.</span><span class=n>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MetaExpression</span><span class=p>(</span><span class=k>val</span> <span class=py>data</span><span class=p>:</span> <span class=n>String</span><span class=p>):</span> <span class=n>Expression</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>interpret</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>String</span><span class=p>):</span> <span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>context</span><span class=p>.</span><span class=n>contains</span><span class=p>(</span><span class=k>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>interpretDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>rick</span> <span class=p>=</span> <span class=n>MetaExpression</span><span class=p>(</span><span class=s2>&#34;rick&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>morty</span> <span class=p>=</span> <span class=n>MetaExpression</span><span class=p>(</span><span class=s2>&#34;morty&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>println</span><span class=p>(</span><span class=n>NotExpression</span><span class=p>(</span><span class=n>rick</span><span class=p>).</span><span class=n>interpret</span><span class=p>(</span><span class=s2>&#34;rick&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>println</span><span class=p>(</span><span class=n>AndExpression</span><span class=p>(</span><span class=n>rick</span><span class=p>,</span><span class=n>morty</span><span class=p>).</span><span class=n>interpret</span><span class=p>(</span><span class=s2>&#34;rick and morty&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>println</span><span class=p>(</span><span class=n>AndExpression</span><span class=p>(</span><span class=n>rick</span><span class=p>,</span><span class=n>NotExpression</span><span class=p>(</span><span class=n>morty</span><span class=p>)).</span><span class=n>interpret</span><span class=p>(</span><span class=s2>&#34;rick and morty&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1>// false,true,f
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><h4 id=strategy>Strategy</h4><p>策略</p><p>创建定义一系列的算法的各种策略对象和一个所执行算法随着策略对象改变而改变的 Context 对象，使得算法可以<strong>自由切换</strong>，且可<strong>独立于它的使用者变化</strong></p><blockquote><p>vs. State Pattern</p></blockquote><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Strategy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>StrategyChoice</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>StrategyConsumer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>strategy</span><span class=p>:</span> <span class=n>Strategy</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>updateStrategy</span><span class=p>(</span><span class=n>strategyChoice</span><span class=p>:</span> <span class=n>StrategyChoice</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>Enemy</span><span class=p>:</span> <span class=n>StrategyChoice</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ATTACK</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>MOVE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>DEFENSE</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//三种策略
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>DefenseStrategy</span><span class=p>:</span> <span class=n>Strategy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;enemy is attacking, take the defense strategy&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MoveStrategy</span><span class=p>:</span> <span class=n>Strategy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;enemy is defensing, take the move strategy&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AttackStrategy</span><span class=p>:</span> <span class=n>Strategy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;enemy is moving, take the attack strategy&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//战士根据敌人的动作切换策略
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>Fighter</span><span class=p>(</span><span class=k>override</span> <span class=k>var</span> <span class=py>strategy</span><span class=p>:</span> <span class=n>Strategy</span> <span class=p>=</span> <span class=n>DefenseStrategy</span><span class=p>())</span> <span class=p>:</span> <span class=n>StrategyContext</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>(</span><span class=n>strategyChoice</span><span class=p>:</span> <span class=n>StrategyChoice</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>strategy</span> <span class=p>=</span> <span class=k>when</span> <span class=p>(</span><span class=n>strategyChoice</span> <span class=k>as</span> <span class=n>Enemy</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nc>Enemy</span><span class=p>.</span><span class=n>ATTACK</span> <span class=o>-&gt;</span> <span class=n>DefenseStrategy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nc>Enemy</span><span class=p>.</span><span class=n>DEFENSE</span> <span class=o>-&gt;</span> <span class=n>MoveStrategy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nc>Enemy</span><span class=p>.</span><span class=n>MOVE</span> <span class=o>-&gt;</span> <span class=n>AttackStrategy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>strategy</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>strategyDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>fighter</span> <span class=p>=</span> <span class=n>Fighter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>fighter</span><span class=p>.</span><span class=n>action</span><span class=p>(</span><span class=nc>Enemy</span><span class=p>.</span><span class=n>DEFENSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fighter</span><span class=p>.</span><span class=n>action</span><span class=p>(</span><span class=nc>Enemy</span><span class=p>.</span><span class=n>MOVE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fighter</span><span class=p>.</span><span class=n>action</span><span class=p>(</span><span class=nc>Enemy</span><span class=p>.</span><span class=n>ATTACK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=visitor>Visitor</h4><p>访问者</p><p>为了访问比较复杂的数据结构，不去改变数据结构，而是把对数据的操作抽象出来，在“访问”的过程中以回调形式<strong>在访问者中处理操作逻辑</strong>。如果要新增一组操作，那么只需要增加一个新的访问者。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>Element</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>fun</span><span class=w> </span><span class=nf>accept</span><span class=p>(</span><span class=n>visitor</span><span class=p>:</span><span class=w> </span><span class=n>Visitor</span><span class=p>):</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>println</span><span class=p>(</span><span class=s>&#34;universal element output&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>visitor</span><span class=p>.</span><span class=na>visit</span><span class=p>(</span><span class=k>this</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>println</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>interface</span> <span class=nc>Visitor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>fun</span><span class=w> </span><span class=nf>visit</span><span class=p>(</span><span class=n>element</span><span class=p>:</span><span class=w> </span><span class=n>Element</span><span class=p>):</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>println</span><span class=p>(</span><span class=s>&#34;universal visitor output&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>Meat</span><span class=p>:</span> <span class=n>Element</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Fruits</span><span class=p>:</span> <span class=n>Element</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Vegetable</span><span class=p>:</span> <span class=n>Element</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Vegetarian</span><span class=p>:</span> <span class=n>Visitor</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>visit</span><span class=p>(</span><span class=n>element</span><span class=p>:</span> <span class=n>Element</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>super</span><span class=p>.</span><span class=n>visit</span><span class=p>(</span><span class=n>element</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I am a vegetarian&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>when</span><span class=p>(</span><span class=n>element</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>Meat</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I hate meat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>Fruits</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I enjoy fruits&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>Vegetable</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I love vegetable&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Carnivore</span><span class=p>:</span> <span class=n>Visitor</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>visit</span><span class=p>(</span><span class=n>element</span><span class=p>:</span> <span class=n>Element</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>super</span><span class=p>.</span><span class=n>visit</span><span class=p>(</span><span class=n>element</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I am a carnivore&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>when</span><span class=p>(</span><span class=n>element</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>Meat</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I love meat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>Fruits</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;Fruits is Ok&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>is</span> <span class=n>Vegetable</span> <span class=o>-&gt;</span> <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I hate vegetable&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>demo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>meat</span><span class=p>:</span> <span class=n>Meat</span> <span class=p>=</span> <span class=n>Meat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>fruits</span><span class=p>:</span> <span class=n>Fruits</span> <span class=p>=</span> <span class=n>Fruits</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>vegetable</span><span class=p>:</span> <span class=n>Vegetable</span> <span class=p>=</span> <span class=n>Vegetable</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>vegetarian</span><span class=p>:</span> <span class=n>Vegetarian</span> <span class=p>=</span> <span class=n>Vegetarian</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>carnivore</span><span class=p>:</span> <span class=n>Carnivore</span> <span class=p>=</span> <span class=n>Carnivore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>meat</span><span class=p>.</span><span class=n>accept</span><span class=p>(</span><span class=n>carnivore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>meat</span><span class=p>.</span><span class=n>accept</span><span class=p>(</span><span class=n>vegetarian</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fruits</span><span class=p>.</span><span class=n>accept</span><span class=p>(</span><span class=n>carnivore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fruits</span><span class=p>.</span><span class=n>accept</span><span class=p>(</span><span class=n>vegetarian</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vegetable</span><span class=p>.</span><span class=n>accept</span><span class=p>(</span><span class=n>carnivore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>vegetable</span><span class=p>.</span><span class=n>accept</span><span class=p>(</span><span class=n>vegetarian</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=应该不考-1>应该不考</h4><h5 id=command>Command</h5><p>命令模式</p><p>数据驱动</p><p>以<strong>命令</strong>（Command）的形式包裹请求，并传给<strong>调用对象</strong>（Invoker）。调用对象寻找可以处理该命令的<strong>合适的对象</strong>（Receiver）来执行命令。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Command</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>execute</span><span class=p>(</span><span class=k>receiver</span><span class=p>:</span> <span class=n>Receiver</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>receiver</span><span class=p>.</span><span class=n>exec</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Receiver</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>exec</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Invoker</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>commands</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Command</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>addCommand</span><span class=p>(</span><span class=n>command</span><span class=p>:</span> <span class=n>Command</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>commands</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>command</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>executeCommands</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>Gardening</span><span class=p>:</span> <span class=n>Command</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Cleaning</span><span class=p>:</span> <span class=n>Command</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Cleaner</span><span class=p>:</span> <span class=n>Receiver</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>exec</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;The house had been cleaned.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Gardener</span><span class=p>:</span> <span class=n>Receiver</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>exec</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;The garden had been taken care of.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Butler</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>commands</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Command</span><span class=p>&gt;)</span> <span class=p>:</span> <span class=n>Invoker</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>val</span> <span class=py>gardener</span> <span class=p>=</span> <span class=n>Gardener</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>val</span> <span class=py>cleaner</span> <span class=p>=</span> <span class=n>Cleaner</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>executeCommands</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>commands</span><span class=p>.</span><span class=n>forEach</span><span class=p>{</span> <span class=n>command</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>            <span class=k>when</span><span class=p>(</span><span class=n>command</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>is</span> <span class=n>Gardening</span> <span class=o>-&gt;</span> <span class=n>command</span><span class=p>.</span><span class=n>execute</span><span class=p>(</span><span class=n>gardener</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>is</span> <span class=n>Cleaning</span> <span class=o>-&gt;</span> <span class=n>command</span><span class=p>.</span><span class=n>execute</span><span class=p>(</span><span class=n>cleaner</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>commands</span><span class=p>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>commandDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>butler</span> <span class=p>=</span> <span class=n>Butler</span><span class=p>(</span><span class=n>ArrayList</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>butler</span><span class=p>.</span><span class=n>addCommand</span><span class=p>(</span><span class=n>Gardening</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>butler</span><span class=p>.</span><span class=n>addCommand</span><span class=p>(</span><span class=n>Cleaning</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>butler</span><span class=p>.</span><span class=n>executeCommands</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=state>State</h5><p>将各状态对应逻辑分拆到不同的状态类中，以达到<strong>易于拓展新状态</strong>的目的。</p><p>存在各种状态State的和一个管理状态切换的 Context</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>State</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span>  <span class=nc>Context</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>currentState</span><span class=p>:</span> <span class=n>State</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>currentState</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>QianJiSan</span><span class=p>(</span><span class=k>override</span> <span class=k>var</span> <span class=py>currentState</span><span class=p>:</span> <span class=n>State</span><span class=p>)</span> <span class=p>:</span> <span class=n>Context</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ShieldForm</span><span class=p>:</span> <span class=n>State</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;ShieldForm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;defense&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SwordForm</span><span class=p>:</span> <span class=n>State</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;SwordForm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;fight&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>stateDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>swordForm</span> <span class=p>=</span> <span class=n>SwordForm</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>shieldForm</span> <span class=p>=</span> <span class=n>ShieldForm</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>qianJiSan</span> <span class=p>=</span> <span class=n>QianJiSan</span><span class=p>(</span><span class=n>swordForm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>qianJiSan</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>qianJiSan</span><span class=p>.</span><span class=n>currentState</span> <span class=p>=</span> <span class=n>shieldForm</span>
</span></span><span class=line><span class=cl>    <span class=n>qianJiSan</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=chain-of-responsibility>Chain-of-responsibility</h5><p>责任链</p><blockquote><p>使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。</p></blockquote><p>责任链模式（Chain of Responsibility）是一种处理请求的模式，它让多个处理器都有机会处理该请求，直到其中某个处理成功为止。责任链模式把多个处理器串成链，然后让请求在链上传递</p><p>责任链模式（Chain of Responsibility Pattern）为请求创建了一个接收者对象的链。这种模式给予请求的类型，对请求的发送者和接收者进行解耦。这种类型的设计模式属于行为型模式。</p><p>在这种模式中，通常每个接收者都包含对另一个接收者的引用。如果一个对象不能处理该请求，那么它会把相同的请求传给下一个接收者，依此类推。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Handler</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>nextHandler</span><span class=p>:</span> <span class=n>Handler</span><span class=p>?</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>authority</span><span class=p>:</span> <span class=n>Priority</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>handle</span><span class=p>(</span><span class=n>priority</span><span class=p>:</span> <span class=n>Priority</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Priority</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>Vampire</span><span class=p>:</span> <span class=n>Priority</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Baron</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Vicomte</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Comte</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Marquess</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Duke</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Infante</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Priest</span><span class=p>:</span> <span class=n>Handler</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>name</span><span class=p>:</span> <span class=n>String</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>val</span> <span class=py>authority</span><span class=p>:</span> <span class=n>Vampire</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>val</span> <span class=py>nextHandler</span><span class=p>:</span> <span class=n>Priest</span><span class=p>?</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>handle</span><span class=p>(</span><span class=n>priority</span><span class=p>:</span> <span class=n>Priority</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>((</span><span class=n>priority</span> <span class=k>as</span> <span class=n>Vampire</span><span class=p>)</span><span class=o>&lt;=</span><span class=n>authority</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$priority</span><span class=s2> wad purified&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>(</span><span class=s2>&#34;request </span><span class=si>${nextHandler?.name?:&#34;god&#34;}</span><span class=s2> to process&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>nextHandler</span><span class=o>?.</span><span class=n>handle</span><span class=p>(</span><span class=n>priority</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//三种神职人员
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>Monk</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>nextHandler</span><span class=p>:</span> <span class=n>Priest</span><span class=p>,</span> <span class=k>override</span> <span class=k>val</span> <span class=py>name</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=s2>&#34;monk&#34;</span><span class=p>,</span> <span class=k>override</span> <span class=k>val</span> <span class=py>authority</span><span class=p>:</span> <span class=n>Vampire</span> <span class=p>=</span> <span class=nc>Vampire</span><span class=p>.</span><span class=n>Vicomte</span><span class=p>)</span> <span class=p>:</span> <span class=n>Priest</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Bishop</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>nextHandler</span><span class=p>:</span> <span class=n>Priest</span><span class=p>,</span> <span class=k>override</span> <span class=k>val</span> <span class=py>name</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=s2>&#34;bishop&#34;</span><span class=p>,</span> <span class=k>override</span> <span class=k>val</span> <span class=py>authority</span><span class=p>:</span> <span class=n>Vampire</span> <span class=p>=</span> <span class=nc>Vampire</span><span class=p>.</span><span class=n>Marquess</span><span class=p>)</span> <span class=p>:</span> <span class=n>Priest</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Pope</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>name</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=s2>&#34;pope&#34;</span><span class=p>,</span> <span class=k>override</span> <span class=k>val</span> <span class=py>authority</span><span class=p>:</span> <span class=n>Vampire</span> <span class=p>=</span> <span class=nc>Vampire</span><span class=p>.</span><span class=n>Duke</span><span class=p>,</span> <span class=k>override</span> <span class=k>val</span> <span class=py>nextHandler</span><span class=p>:</span> <span class=n>Priest</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span><span class=p>)</span> <span class=p>:</span> <span class=n>Priest</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>chainOfResponsibilityDemo</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>pope</span> <span class=p>=</span> <span class=n>Pope</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>bishop</span> <span class=p>=</span> <span class=n>Bishop</span><span class=p>(</span><span class=n>pope</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>monk</span> <span class=p>=</span> <span class=n>Monk</span><span class=p>(</span><span class=n>bishop</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>monk</span><span class=p>.</span><span class=n>handle</span><span class=p>(</span><span class=nc>Vampire</span><span class=p>.</span><span class=n>Duke</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>monk</span><span class=p>.</span><span class=n>handle</span><span class=p>(</span><span class=nc>Vampire</span><span class=p>.</span><span class=n>Infante</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=iterator>Iterator</h5><p>迭代器</p><p>提供一种无需对外暴露集合对象的内部表示就能就遍历集合对象元素的方法</p><p>分离了集合对象的遍历行为，把遍历元素责任交给迭代器，而不是集合对象</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Iterator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>hasNext</span><span class=p>():</span> <span class=n>Boolean</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>next</span><span class=p>():</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Container</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>iterator</span><span class=p>():</span> <span class=n>Iterator</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>Virtue</span><span class=p>:</span> <span class=n>Container</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>virtues</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>String</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>arrayListOf</span><span class=p>(</span><span class=s2>&#34;Chastity&#34;</span><span class=p>,</span><span class=s2>&#34;Diligence&#34;</span><span class=p>,</span><span class=s2>&#34;Charity&#34;</span><span class=p>,</span><span class=s2>&#34;Humility&#34;</span><span class=p>,</span><span class=s2>&#34;Patience&#34;</span><span class=p>,</span><span class=s2>&#34;Temperance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>inner</span> <span class=k>class</span> <span class=nc>VirTueIterator</span><span class=p>:</span> <span class=n>Iterator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>var</span> <span class=py>cur</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>        <span class=k>override</span> <span class=k>fun</span> <span class=nf>hasNext</span><span class=p>():</span> <span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>cur</span><span class=p>&lt;</span><span class=n>virtues</span><span class=p>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>override</span> <span class=k>fun</span> <span class=nf>next</span><span class=p>():</span> <span class=n>String</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>virtues</span><span class=p>[</span><span class=n>cur</span><span class=o>++</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>iterator</span><span class=p>():</span> <span class=n>Iterator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>VirTueIterator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=mediator>Mediator</h5><p>中介</p><p>用一个中介对象来处理不同类/对象之间的通信，把多方会谈变成双方会谈，以降低多个类之间的通信复杂性。</p><p>中介者使各个类不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Mediator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>communicators</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Communicator</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>deliver</span><span class=p>(</span><span class=n>message</span><span class=p>:</span> <span class=n>Message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Message</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Communicator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>mediator</span><span class=p>:</span> <span class=n>Mediator</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>sendMessage</span><span class=p>(</span><span class=n>message</span><span class=p>:</span> <span class=n>Message</span><span class=p>,</span> <span class=k>receiver</span><span class=p>:</span> <span class=n>Communicator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>receiveMessage</span><span class=p>(</span><span class=n>message</span><span class=p>:</span> <span class=n>Message</span><span class=p>,</span> <span class=n>sender</span><span class=p>:</span> <span class=n>Communicator</span><span class=p>)</span> <span class=p>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>ChatMessage</span><span class=p>(</span><span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>String</span><span class=p>)</span> <span class=p>:</span> <span class=n>Message</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ChatRoom</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>communicators</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Communicator</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>Mediator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>deliver</span><span class=p>(</span><span class=n>message</span><span class=p>:</span> <span class=n>Message</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>((</span><span class=n>message</span> <span class=k>as</span> <span class=n>ChatMessage</span><span class=p>).</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ChatUser</span><span class=p>(</span><span class=k>val</span> <span class=py>name</span><span class=p>:</span> <span class=n>String</span><span class=p>,</span> <span class=k>override</span> <span class=k>val</span> <span class=py>mediator</span><span class=p>:</span> <span class=n>ChatRoom</span><span class=p>)</span> <span class=p>:</span> <span class=n>Communicator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>sendMessage</span><span class=p>(</span><span class=n>message</span><span class=p>:</span> <span class=n>Message</span><span class=p>,</span> <span class=k>receiver</span><span class=p>:</span> <span class=n>Communicator</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$name</span><span class=s2> send a message to </span><span class=si>${(receiver as ChatUser).name}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>mediator</span><span class=p>.</span><span class=n>deliver</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=memento>Memento</h5><p>备忘录</p><p>在不破坏封装性的前提下，在某对象之外保存该对象的内部状态，以便在适当的时候恢复对象</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Originator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>states</span><span class=p>:</span> <span class=n>States</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>save</span><span class=p>():</span> <span class=n>Memonto</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>load</span><span class=p>(</span><span class=n>memonto</span><span class=p>:</span> <span class=n>Memonto</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>States</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Memonto</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>states</span><span class=p>:</span> <span class=n>States</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>load</span><span class=p>():</span> <span class=n>States</span> <span class=p>{</span><span class=k>return</span> <span class=n>states</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>data</span> <span class=k>class</span> <span class=nc>GameStates</span><span class=p>(</span><span class=k>val</span> <span class=py>level</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span> <span class=k>val</span> <span class=py>stage</span><span class=p>:</span> <span class=n>Int</span><span class=p>):</span> <span class=n>States</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>GameArchive</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>states</span><span class=p>:</span> <span class=n>States</span><span class=p>)</span> <span class=p>:</span> <span class=n>Memonto</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Game</span><span class=p>(</span><span class=k>override</span> <span class=k>var</span> <span class=py>states</span><span class=p>:</span> <span class=n>States</span> <span class=p>=</span> <span class=n>GameStates</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=m>1</span><span class=p>))</span> <span class=p>:</span> <span class=n>Originator</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>save</span><span class=p>():</span> <span class=n>Memonto</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;game archive is saved&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>GameArchive</span><span class=p>(</span><span class=n>states</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>load</span><span class=p>(</span><span class=n>memonto</span><span class=p>:</span> <span class=n>Memonto</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>states</span> <span class=p>=</span> <span class=n>memonto</span><span class=p>.</span><span class=n>states</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;game archive is loaded&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>memontoDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>game</span> <span class=p>=</span> <span class=n>Game</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>archi</span> <span class=p>=</span> <span class=n>game</span><span class=p>.</span><span class=n>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>game</span><span class=p>.</span><span class=n>load</span><span class=p>(</span><span class=n>archi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=template-method>Template-method</h5><p>模板方法</p><p>一个抽象类/接口公开定义了执行它的方法的模板“骨架”。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>abstract</span> <span class=k>class</span> <span class=nc>Template</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=k>abstract</span> <span class=k>fun</span> <span class=nf>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=k>abstract</span> <span class=k>fun</span> <span class=nf>second</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=k>abstract</span> <span class=k>fun</span> <span class=nf>last</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>final</span> <span class=k>fun</span> <span class=nf>steps</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>second</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>last</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>Human</span><span class=p>:</span> <span class=n>Template</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>first</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;birth&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>second</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;aging&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>last</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;death&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>templateDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>human</span> <span class=p>=</span> <span class=n>Human</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>human</span><span class=p>.</span><span class=n>steps</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=结构型模式>结构型模式</h3><p>不仅仅简单地使用继承，而更多地通过组合与运行期的动态组合来实现更好、更灵活的结构与功能</p><h4 id=adapter>Adapter</h4><p>适配器</p><p>作为两个不兼容的接口之间的桥梁，将一个类的接口转换成客户希望的另外一个接口以结合了两个独立接口的功能，使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Destination</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>func1</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Source</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>func2</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Adapter</span><span class=p>:</span> <span class=n>Destination</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>source</span><span class=p>:</span> <span class=n>Source</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>fun1</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>Wizard</span><span class=p>:</span> <span class=n>Source</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>func2</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;Attack Power&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>open</span> <span class=k>class</span> <span class=nc>Warrior</span><span class=p>:</span> <span class=n>Destination</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>func1</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;Attack Damage&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WizardWarrior</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>source</span><span class=p>:</span> <span class=n>Source</span><span class=p>)</span> <span class=p>:</span> <span class=n>Warrior</span><span class=p>(),</span><span class=n>Adapter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>func1</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>super</span><span class=p>.</span><span class=n>func1</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span><span class=p>.</span><span class=n>func2</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=proxy>Proxy</h4><p>代理</p><p>创建具有某对象的代理对象，以便<strong>代表</strong>改对象向外界提供功能接口。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>Original</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=kt>void</span><span class=w> </span><span class=nf>action</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>interface</span> <span class=nc>Proxy</span><span class=p>:</span><span class=w> </span><span class=n>Original</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>val</span><span class=w> </span><span class=n>original</span><span class=p>:</span><span class=w> </span><span class=n>Original</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>override</span><span class=w> </span><span class=n>fun</span><span class=w> </span><span class=nf>action</span><span class=p>():</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>original</span><span class=p>.</span><span class=na>action</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>HttpService</span><span class=p>:</span> <span class=n>Original</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;HTTP Service offered&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EvilHttpService</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>original</span><span class=p>:</span> <span class=n>HttpService</span><span class=p>)</span> <span class=p>:</span> <span class=n>Proxy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>fun</span> <span class=nf>check</span><span class=p>()</span> <span class=p>:</span><span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=m>1.</span><span class=p>.</span><span class=m>2</span><span class=p>).</span><span class=n>random</span><span class=p>()&lt;</span><span class=m>2</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;HTTP request is censored&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>val</span> <span class=py>youAreAGoodPerson</span> <span class=p>=</span> <span class=n>check</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>youAreAGoodPerson</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>original</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span><span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>(</span><span class=s2>&#34;your access is denied!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>demo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>httpService</span> <span class=p>=</span> <span class=n>EvilHttpService</span><span class=p>(</span><span class=n>HttpService</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=n>httpService</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=decorator>Decorator</h4><p>装饰器</p><p>作为现有的类的一个<strong>包装</strong>，向一个现有的对象添加新的功能，同时又不改变其结构，装饰和数据源类<strong>实现同一接口</strong>， 从而能在客户端代码中<strong>相互替换</strong>。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>Original</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>fun</span><span class=w> </span><span class=nf>action</span><span class=p>():</span><span class=w> </span><span class=n>Unit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>interface</span> <span class=nc>Decorator</span><span class=p>:</span><span class=w> </span><span class=n>Original</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>val</span><span class=w> </span><span class=n>original</span><span class=p>:</span><span class=w> </span><span class=n>Original</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>fun</span><span class=w> </span><span class=nf>before</span><span class=p>():</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>fun</span><span class=w> </span><span class=nf>after</span><span class=p>():</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>override</span><span class=w> </span><span class=n>fun</span><span class=w> </span><span class=nf>action</span><span class=p>():</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>before</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>original</span><span class=p>.</span><span class=na>action</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>after</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>println</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>Mage</span><span class=p>:</span> <span class=n>Original</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>action</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;I am a mage&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FireMage</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>original</span><span class=p>:</span> <span class=n>Original</span><span class=p>):</span> <span class=n>Decorator</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>after</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;A FireMage to be exact&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;Incendio&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>IceMage</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>original</span><span class=p>:</span> <span class=n>Original</span><span class=p>):</span> <span class=n>Decorator</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>after</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;A IceMage to be exact&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;freezing charm&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>demo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>fireMage</span> <span class=p>=</span> <span class=n>FireMage</span><span class=p>(</span><span class=n>Mage</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>iceMage</span> <span class=p>=</span> <span class=n>IceMage</span><span class=p>(</span><span class=n>Mage</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>fireMage</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>iceMage</span><span class=p>.</span><span class=n>action</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p><strong>代理</strong>模式，注重对对象某一功能的流程把控和辅助。 它可以控制对象做某些事，重心是为了借用对象的功能完成某一流程，而非对象功能如何。</p><p><strong>装饰</strong>模式，注重对对象功能的扩展，它不关心外界如何调用，只注重对对象功能的加强，<strong>装饰</strong>后还是对象本身。</p></blockquote><h4 id=应该不考-2>应该不考</h4><h5 id=bridge>Bridge</h5><p>桥接</p><p>又称为柄体(Handle and Body)模式或接口(Interfce)模式</p><p>将抽象接口作为抽象化和实现化之间的桥接结构，把<strong>抽象化与实现化解耦</strong>，使得实体类的功能独立于接口实现类，使得二者可以<strong>独立变化</strong>。避免有多种可能会变化的情况下直接继承带来的子类爆炸问题，提高扩展的灵活性。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Bridge</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Entity</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>bridge</span><span class=p>:</span> <span class=n>Bridge</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>abstract</span> <span class=k>class</span> <span class=nc>Mecha</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>bridge</span><span class=p>:</span> <span class=n>EnergyCore</span><span class=p>)</span> <span class=p>:</span> <span class=n>Entity</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>internal</span> <span class=k>abstract</span> <span class=k>fun</span> <span class=nf>statement</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>statement</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>bridge</span><span class=p>.</span><span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//不同机甲型号可搭配不同能源核心，使得二者均易于拓展
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>MechaI</span><span class=p>(</span><span class=n>core</span><span class=p>:</span> <span class=n>EnergyCore</span><span class=p>):</span> <span class=n>Mecha</span><span class=p>(</span><span class=n>bridge</span> <span class=p>=</span> <span class=n>core</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>statement</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;MechaI&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MechaV</span><span class=p>(</span><span class=n>core</span><span class=p>:</span> <span class=n>EnergyCore</span><span class=p>):</span> <span class=n>Mecha</span><span class=p>(</span><span class=n>bridge</span> <span class=p>=</span> <span class=n>core</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>statement</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;MechaV&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MechaX</span><span class=p>(</span><span class=n>core</span><span class=p>:</span> <span class=n>EnergyCore</span><span class=p>):</span> <span class=n>Mecha</span><span class=p>(</span><span class=n>bridge</span> <span class=p>=</span> <span class=n>core</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>statement</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;MechaX&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>EnergyCore</span><span class=p>:</span> <span class=n>Bridge</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SolarEnergyCore</span><span class=p>:</span> <span class=n>EnergyCore</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;solar energy is transforming into power&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WindEnergyCore</span><span class=p>:</span> <span class=n>EnergyCore</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;wind energy is transforming into power&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>bridgeDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MechaI</span><span class=p>(</span><span class=n>WindEnergyCore</span><span class=p>()).</span><span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>MechaI</span><span class=p>(</span><span class=n>SolarEnergyCore</span><span class=p>()).</span><span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>MechaV</span><span class=p>(</span><span class=n>WindEnergyCore</span><span class=p>()).</span><span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>MechaV</span><span class=p>(</span><span class=n>SolarEnergyCore</span><span class=p>()).</span><span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>MechaX</span><span class=p>(</span><span class=n>WindEnergyCore</span><span class=p>()).</span><span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>MechaX</span><span class=p>(</span><span class=n>SolarEnergyCore</span><span class=p>()).</span><span class=n>func</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=composite>Composite</h5><p>组合</p><p>又称为<strong>部分整体模式</strong>，依据树形结构来组合对象，创建了一个包含自己对象组的类，把<strong>一组</strong>相似的对象当作一个单一的对象处理。使得用户对单个对象和组合对象的使用具有<strong>一致性</strong>。</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Composite</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>composites</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Composite</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>HTMLElement</span><span class=p>:</span> <span class=n>Composite</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>String</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>toHTML</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>composites</span><span class=p>.</span><span class=n>forEach</span> <span class=p>{</span> <span class=k>it</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>it</span> <span class=k>as</span> <span class=n>HTMLElement</span><span class=p>).</span><span class=n>toHTML</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>HTML</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span><span class=k>override</span> <span class=k>val</span> <span class=py>composites</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Composite</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>HTMLElement</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>toHTML</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;&lt;html&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>super</span><span class=p>.</span><span class=n>toHTML</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;&lt;/html&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Body</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span><span class=k>override</span> <span class=k>val</span> <span class=py>composites</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Composite</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>HTMLElement</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>toHTML</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;&lt;body&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>super</span><span class=p>.</span><span class=n>toHTML</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;&lt;/body&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>H1</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span><span class=k>override</span> <span class=k>val</span> <span class=py>composites</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Composite</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>HTMLElement</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>toHTML</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;&lt;h1&gt; </span><span class=si>$content</span><span class=s2> &lt;/h1&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>P</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>content</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span><span class=k>override</span> <span class=k>val</span> <span class=py>composites</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Composite</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>HTMLElement</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>toHTML</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;&lt;p&gt; </span><span class=si>$content</span><span class=s2> &lt;/p&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>compositeDemo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>html</span> <span class=p>=</span> <span class=n>HTML</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>body</span> <span class=p>=</span> <span class=n>Body</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span><span class=p>.</span><span class=n>composites</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>H1</span><span class=p>(</span><span class=s2>&#34;header&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span><span class=p>.</span><span class=n>composites</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>P</span><span class=p>(</span><span class=s2>&#34;a paragraph&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span><span class=p>.</span><span class=n>composites</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>P</span><span class=p>(</span><span class=s2>&#34;another paragraph&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>html</span><span class=p>.</span><span class=n>composites</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>html</span><span class=p>.</span><span class=n>toHTML</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=facade>Facade</h5><p>外观</p><p>对外隐藏具有诸多子系统的系统的复杂性，只提供一个可以访问系统的接口</p><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Facade</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>subsystems</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Subsystem</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>react</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>Subsystem</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>react</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>class</span> <span class=nc>ForeignAffairsMinistry</span><span class=p>:</span> <span class=n>Subsystem</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>react</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;The Ministry of Foreign Affairs intervened&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>NationalDefenseMinistry</span><span class=p>:</span> <span class=n>Subsystem</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>react</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;The Ministry of Defense conducts military mobilization&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Government</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>subsystems</span><span class=p>:</span> <span class=n>ArrayList</span><span class=p>&lt;</span><span class=n>Subsystem</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>ArrayList</span><span class=p>())</span> <span class=p>:</span> <span class=n>Facade</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>val</span> <span class=py>foreignAffairsMinistry</span><span class=p>:</span> <span class=n>ForeignAffairsMinistry</span> <span class=p>=</span> <span class=n>ForeignAffairsMinistry</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>val</span> <span class=py>nationalDefenseMinistry</span><span class=p>:</span> <span class=n>NationalDefenseMinistry</span> <span class=p>=</span> <span class=n>NationalDefenseMinistry</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>react</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>((</span><span class=m>1.</span><span class=p>.</span><span class=m>2</span><span class=p>).</span><span class=n>random</span><span class=p>()&lt;</span><span class=m>2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>foreignAffairsMinistry</span><span class=p>.</span><span class=n>react</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span><span class=k>else</span> <span class=n>nationalDefenseMinistry</span><span class=p>.</span><span class=n>react</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=flyweight>Flyweight</h5><p>通过工厂方法尝试重用现有的同类对象以减少创建对象的数量，以减少内存占用和提高性能，如果未找到匹配的对象，则创建新对象</p><p>在实际应用中，享元模式主要应用于<strong>缓存</strong></p><blockquote><p>vs. Singleton</p><p>单例模式是类级别的，一个类<strong>只能有一个</strong>对象实例；</p><p>享元模式是对象级别的，<strong>可以有多个</strong>对象实例，并允许多个变量引用同一个对象实例；</p></blockquote><p><strong>abstract</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>FlyWeight</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>FlyWeightEnum</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>interface</span> <span class=nc>FlyWeightFactory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>map</span><span class=p>:</span> <span class=n>Map</span><span class=p>&lt;</span><span class=n>FlyWeightEnum</span><span class=p>,</span><span class=n>FlyWeight</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>getFlyWeight</span><span class=p>(</span><span class=n>flyWeightEnum</span><span class=p>:</span> <span class=n>FlyWeightEnum</span><span class=p>):</span> <span class=n>FlyWeight</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>implementation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>FaithOfTheSeven</span><span class=p>:</span> <span class=n>FlyWeightEnum</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Father</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Mother</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Warrior</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Smith</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Maiden</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Crone</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>Stranger</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Deity</span><span class=p>(</span><span class=k>private</span> <span class=k>val</span> <span class=py>priesthood</span><span class=p>:</span> <span class=n>FaithOfTheSeven</span> <span class=p>=</span> <span class=nc>FaithOfTheSeven</span><span class=p>.</span><span class=n>Father</span><span class=p>):</span> <span class=n>FlyWeight</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>answerPrayer</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$priesthood</span><span class=s2> answered the prayer&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Church</span><span class=p>(</span><span class=k>override</span> <span class=k>val</span> <span class=py>map</span><span class=p>:</span> <span class=n>HashMap</span><span class=p>&lt;</span><span class=n>FlyWeightEnum</span><span class=p>,</span> <span class=n>Deity</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>HashMap</span><span class=p>())</span> <span class=p>:</span> <span class=n>FlyWeightFactory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>getFlyWeight</span><span class=p>(</span><span class=n>flyWeightEnum</span><span class=p>:</span> <span class=n>FlyWeightEnum</span><span class=p>):</span> <span class=n>Deity</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(!</span><span class=n>map</span><span class=p>.</span><span class=n>containsKey</span><span class=p>(</span><span class=n>flyWeightEnum</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>map</span><span class=p>[</span><span class=n>flyWeightEnum</span><span class=p>]</span> <span class=p>=</span> <span class=n>Deity</span><span class=p>(</span><span class=n>flyWeightEnum</span> <span class=k>as</span> <span class=n>FaithOfTheSeven</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$flyWeightEnum</span><span class=s2> was awakened&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>map</span><span class=p>.</span><span class=n>getOrDefault</span><span class=p>(</span><span class=n>flyWeightEnum</span><span class=p>,</span> <span class=n>Deity</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>pray</span><span class=p>(</span><span class=n>flyWeightEnum</span><span class=p>:</span> <span class=n>FlyWeightEnum</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>println</span><span class=p>(</span><span class=s2>&#34;The believers prayed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>getFlyWeight</span><span class=p>(</span><span class=n>flyWeightEnum</span><span class=p>).</span><span class=n>answerPrayer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=design-pattern-in-power-point>Design Pattern in Power Point</h3><ul><li>duck 1004 strategy</li><li>coffee 1025 decorator</li></ul><h2 id=software-architecture>Software architecture</h2><h3 id=管道过滤器风格><strong>管道过滤器风格</strong></h3><p>pipes and filters</p><ul><li><p>Filter</p><p>Component</p></li><li><p>Pipe</p><p>Connector</p></li></ul><p><img src=https://i.ibb.co/M2BQsDm/image-20221126105636724.png loading=lazy alt=image-20221126105636724></p><p><img src=https://i.ibb.co/gzssXnZ/image-20221126110332719.png loading=lazy alt=image-20221126110332719></p><h3 id=主程序子程序风格><strong>主程序/子程序风格</strong></h3><p>Main program and subroutine</p><ul><li>Hierarchical decomposition:
Based on definition-use relations<ul><li>Definition-call</li><li>Call-return</li></ul></li><li>Single thread of control
Supported directly by programming languages</li></ul><h3 id=面向对象风格><strong>面向对象风格</strong></h3><p>Object-Oriented Organization</p><ul><li><p>Each object contains <strong>data and operations</strong> on these data.</p></li><li><p>Data within an object can only be accessed by methods of its inclosing object.</p></li><li><p>Object is probably instantiated from a template (Class)</p></li><li><p>feature</p><ul><li><p>Encapsulation</p><p>Restrict access to certain information</p></li><li><p>Polymorphism</p><p>Choose the method at run-time</p></li><li><p>Inheritance</p><p>take over (or inherit) attributes and behavior of the pre-existing classes</p></li></ul></li></ul><h3 id=分层的风格><strong>分层的风格</strong></h3><p>Call and return systems</p><ul><li>Main program and subroutine</li><li>OO Systems</li><li>Hierarchical layer</li></ul><h3 id=基于共享数据的事件风格><strong>基于共享数据的事件风格</strong></h3><ul><li>Individual components announce event to communicate with others (Publish)</li><li>Other components may register an interest in the kind of events (subscribe). They are invoked when the event appear</li></ul><p><img src=https://i.ibb.co/TRKDBBP/image-20221126112413531.png loading=lazy alt=image-20221126112413531></p><p><img src=https://i.ibb.co/xf55WM9/image-20221126112433663.png loading=lazy alt=image-20221126112433663></p><h3 id=powerpoint>PowerPoint</h3><ul><li><p>软件体系结构＝（元素，形态，基本理论）</p></li><li><p>软件体系结构层次的设计主要包括以下方面：</p><ul><li>组成系统的构件<strong>描述</strong></li><li>构件之间的<strong>交互</strong></li><li>指导构件交互的<strong>模式</strong></li><li>施加在模式上的<strong>约束</strong></li></ul></li><li><p>一个软件系统的体系结构定义了组成系统的</p><ul><li><p>构件（components）</p><p>构件用于<strong>实施计算和保存状态</strong></p></li><li><p>连接件（connectors）</p><p>连接件用于表达构件之间的<strong>关系</strong></p></li><li><p>和它们之间的匹配</p><p>构件和连接件之间的匹 配表示了系统的<strong>拓扑结构</strong></p></li></ul></li><li><ul><li><p>Components:</p><p>define the locus of <strong>computation</strong></p><p>Examples: filters, databases, objects, clients/servers</p></li><li><p>Connectors:</p><p>mediate component <strong>interactions</strong></p><p>Examples: procedure call, pipes, event broadcast</p></li></ul></li><li><p>Batch Sequential Systems</p><ul><li>Processing steps are <strong>independent programs</strong></li><li>Each step runs to <strong>completion</strong> before next step starts</li><li>Data transmitted <strong>as a whole</strong> between steps</li><li>Typical applications:<ul><li>classical data processing</li><li>program development</li></ul></li></ul></li><li><p>data flow System</p><ul><li>A data flow system is one in which<ul><li>the <strong>availability of data</strong> controls the computation</li><li>the structure of the design is dominated by <strong>orderly motion of data</strong> from process to process</li><li>the pattern of data flow is <strong>explicit</strong></li></ul></li><li>In a pure data flow system, there is <strong>no other interaction</strong> between processes</li></ul></li></ul></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Jun 06, 2023 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/software-architecturenotes/><div class=article-details><h2 class=article-title>【Software Architecture】Notes</h2></div></a></article><article><a href=/p/computer-architecturenotes/><div class=article-details><h2 class=article-title>【Computer Architecture】Notes</h2></div></a></article><article><a href=/p/computer-networknotes/><div class=article-details><h2 class=article-title>【Computer Network】Notes</h2></div></a></article><article><a href=/p/computer-visionnotes/><div class=article-details><h2 class=article-title>【Computer Vision】Notes</h2></div></a></article><article><a href=/p/stanford-compilersnotes/><div class=article-details><h2 class=article-title>【Stanford Compilers】Notes</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 飞鸿踏雪泥</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>