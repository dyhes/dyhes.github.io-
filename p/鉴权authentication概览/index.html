<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="RePost from :\n一文教你搞定所有前端鉴权与后端鉴权方案，让你不再迷惘 - 掘金 (juejin.cn)\nTerminology 认证(Identification) ：根据声明者所特有的识别信息，确认声明者的身份。 身份证，用户名和密码等\n授权(Authorization)： 在信息安全领域是指资源所有者委派执行者，赋予执行者指定范围的资源操作权限，以便对资源的相关操作。\n现实生活领域： 银行卡（由银行派发）、门禁卡（由物业管理处派发）、钥匙（由房东派发）\n互联网领域： web 服务器的 session 机制、web 浏览器的 cookie 机制、颁发授权令牌（token）等\n鉴权(Authentication)： 在信息安全领域是指对于一个声明者所声明的身份权利，对其所声明的真实性进行鉴别确认的过程。授权和鉴权是两个上下游相匹配的关系，先授权，后鉴权。\n现实生活领域： 门禁卡需要通过门禁卡识别器，银行卡需要通过银行卡识别器；\n互联网领域： 校验 session/cookie/token 的合法性和有效性\n权限控制(Access/Permission Control)： 将可执行的操作定义为权限列表，然后判断操作是否允许/禁止 对于权限控制，可以分为两部分进行理解：一个是权限，另一个是控制。权限是抽象的逻辑概念，而控制是具体的实现方式。\n现实生活领域： 门禁卡的权限\n互联网领域： 通过 web 后端服务，控制接口访问，允许或拒绝访问请求\n关系 前后依次发生\n使用门禁卡开门： 认证、授权、鉴权、权限控制四个环节一气呵成，在瞬间同时发生\n用户的网站登录： 用户在使用用户名和密码进行登录时，认证和授权两个环节一同完成，而鉴权和权限控制则发生在后续的请求访问中，比如在选购物品或支付时。\nHTTP基本鉴权 在 HTTP 中，基本认证方案（Basic Access Authentication) 是允许客户端（通常指的就是网页浏览器）在请求时，通过用户提供用户名和密码的方式，实现对用户身份的验证。\n几乎所有网站都不会使用此认证方案\n"><title>【鉴权】Authentication概览</title>
<link rel=canonical href=https://dyhes.github.io/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/><link rel=stylesheet href=/scss/style.min.6aa4d43a5cae1c51ef34b3f851ae7421f4b2f2d13827e2d975acbeb4f13c8710.css><meta property='og:title' content="【鉴权】Authentication概览"><meta property='og:description' content="RePost from :\n一文教你搞定所有前端鉴权与后端鉴权方案，让你不再迷惘 - 掘金 (juejin.cn)\nTerminology 认证(Identification) ：根据声明者所特有的识别信息，确认声明者的身份。 身份证，用户名和密码等\n授权(Authorization)： 在信息安全领域是指资源所有者委派执行者，赋予执行者指定范围的资源操作权限，以便对资源的相关操作。\n现实生活领域： 银行卡（由银行派发）、门禁卡（由物业管理处派发）、钥匙（由房东派发）\n互联网领域： web 服务器的 session 机制、web 浏览器的 cookie 机制、颁发授权令牌（token）等\n鉴权(Authentication)： 在信息安全领域是指对于一个声明者所声明的身份权利，对其所声明的真实性进行鉴别确认的过程。授权和鉴权是两个上下游相匹配的关系，先授权，后鉴权。\n现实生活领域： 门禁卡需要通过门禁卡识别器，银行卡需要通过银行卡识别器；\n互联网领域： 校验 session/cookie/token 的合法性和有效性\n权限控制(Access/Permission Control)： 将可执行的操作定义为权限列表，然后判断操作是否允许/禁止 对于权限控制，可以分为两部分进行理解：一个是权限，另一个是控制。权限是抽象的逻辑概念，而控制是具体的实现方式。\n现实生活领域： 门禁卡的权限\n互联网领域： 通过 web 后端服务，控制接口访问，允许或拒绝访问请求\n关系 前后依次发生\n使用门禁卡开门： 认证、授权、鉴权、权限控制四个环节一气呵成，在瞬间同时发生\n用户的网站登录： 用户在使用用户名和密码进行登录时，认证和授权两个环节一同完成，而鉴权和权限控制则发生在后续的请求访问中，比如在选购物品或支付时。\nHTTP基本鉴权 在 HTTP 中，基本认证方案（Basic Access Authentication) 是允许客户端（通常指的就是网页浏览器）在请求时，通过用户提供用户名和密码的方式，实现对用户身份的验证。\n几乎所有网站都不会使用此认证方案\n"><meta property='og:url' content='https://dyhes.github.io/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/'><meta property='og:site_name' content='飞鸿踏雪泥'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='authentication'><meta property='article:published_time' content='2022-11-09T00:00:00+00:00'><meta property='article:modified_time' content='2022-11-09T00:00:00+00:00'><meta property='og:image' content='https://dyhes.github.io/covers/cover3.png'><meta name=twitter:title content="【鉴权】Authentication概览"><meta name=twitter:description content="RePost from :\n一文教你搞定所有前端鉴权与后端鉴权方案，让你不再迷惘 - 掘金 (juejin.cn)\nTerminology 认证(Identification) ：根据声明者所特有的识别信息，确认声明者的身份。 身份证，用户名和密码等\n授权(Authorization)： 在信息安全领域是指资源所有者委派执行者，赋予执行者指定范围的资源操作权限，以便对资源的相关操作。\n现实生活领域： 银行卡（由银行派发）、门禁卡（由物业管理处派发）、钥匙（由房东派发）\n互联网领域： web 服务器的 session 机制、web 浏览器的 cookie 机制、颁发授权令牌（token）等\n鉴权(Authentication)： 在信息安全领域是指对于一个声明者所声明的身份权利，对其所声明的真实性进行鉴别确认的过程。授权和鉴权是两个上下游相匹配的关系，先授权，后鉴权。\n现实生活领域： 门禁卡需要通过门禁卡识别器，银行卡需要通过银行卡识别器；\n互联网领域： 校验 session/cookie/token 的合法性和有效性\n权限控制(Access/Permission Control)： 将可执行的操作定义为权限列表，然后判断操作是否允许/禁止 对于权限控制，可以分为两部分进行理解：一个是权限，另一个是控制。权限是抽象的逻辑概念，而控制是具体的实现方式。\n现实生活领域： 门禁卡的权限\n互联网领域： 通过 web 后端服务，控制接口访问，允许或拒绝访问请求\n关系 前后依次发生\n使用门禁卡开门： 认证、授权、鉴权、权限控制四个环节一气呵成，在瞬间同时发生\n用户的网站登录： 用户在使用用户名和密码进行登录时，认证和授权两个环节一同完成，而鉴权和权限控制则发生在后续的请求访问中，比如在选购物品或支付时。\nHTTP基本鉴权 在 HTTP 中，基本认证方案（Basic Access Authentication) 是允许客户端（通常指的就是网页浏览器）在请求时，通过用户提供用户名和密码的方式，实现对用户身份的验证。\n几乎所有网站都不会使用此认证方案\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://dyhes.github.io/covers/cover3.png'><link rel="shortcut icon" href=/github.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu17834253352308399148.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>飞鸿踏雪泥</a></h1><h2 class=site-description>没有记录，就没有发生</h2></div></header><ol class=menu-social><li><a href=https://github.com/dyhes target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:dyheslin@gmail.com target=_blank title=Gmail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-gmail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16 20h3a1 1 0 001-1V5a1 1 0 00-1-1h-3v16z"/><path d="M5 20h3V4H5A1 1 0 004 5v14a1 1 0 001 1z"/><path d="M16 4l-4 4-4-4"/><path d="M4 6.5l8 7.5 8-7.5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/categories/><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#terminology>Terminology</a></li><li><a href=#关系>关系</a></li><li><a href=#http基本鉴权>HTTP基本鉴权</a><ol><li><a href=#缺点>缺点</a></li></ol></li><li><a href=#session-cookie-鉴权>Session-Cookie 鉴权</a><ol><li><a href=#cookie>Cookie</a></li><li><a href=#session>Session</a></li></ol></li><li><a href=#token-鉴权>Token 鉴权</a><ol><li><a href=#token>Token</a></li><li><a href=#refresh-token>Refresh Token</a></li><li><a href=#与-session-cookie-的区别>与 Session-Cookie 的区别</a></li></ol></li><li><a href=#jwtjson-web-token鉴权>JWT（JSON Web Token）鉴权</a><ol><li><a href=#jwt>JWT</a></li></ol></li><li><a href=#单点登录single-sign-on>单点登录（Single Sign On）</a><ol><li><a href=#同域sso>同域SSO</a></li><li><a href=#异域sso>异域SSO</a></li></ol></li><li><a href=#oauth-20>OAuth 2.0</a><ol><li><a href=#授权码模式authorization-code-grant>授权码模式（Authorization Code Grant)</a></li><li><a href=#隐藏式模式implicit-grant>隐藏式模式（Implicit Grant）</a></li><li><a href=#用户名密码式模式password-credentials-grant>用户名密码式模式（Password Credentials Grant）</a></li><li><a href=#客户端模式client-credentials-grant>客户端模式（Client Credentials Grant）</a></li><li><a href=#选型>选型</a></li></ol></li><li><a href=#联合登录和信任登录>联合登录和信任登录</a></li><li><a href=#唯一登录>唯一登录</a></li><li><a href=#扫码登录>扫码登录</a></li><li><a href=#一键登录适用于原生app>一键登录（适用于原生APP）</a></li><li><a href=#总结>总结</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/><img src=/covers/cover3.png loading=lazy alt="Featured image of post 【鉴权】Authentication概览"></a></div><div class=article-details><header class=article-category><a href=/categories/stone/ style=background-color:#c4cbcf;color:>他山石</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/>【鉴权】Authentication概览</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 09, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><p>RePost from :</p><p><a class=link href=https://juejin.cn/post/7129298214959710244#heading-25 target=_blank rel=noopener>一文教你搞定所有前端鉴权与后端鉴权方案，让你不再迷惘 - 掘金 (juejin.cn)</a></p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image.png width=1069 height=863 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image_hu2742689879485737497.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image_hu15718841280621716380.png 1024w" loading=lazy alt=前端鉴权 class=gallery-image data-flex-grow=123 data-flex-basis=297px></p><h2 id=terminology>Terminology</h2><ul><li><p><strong>认证(Identification)</strong> ：根据声明者所特有的识别信息，确认声明者的身份。
身份证，用户名和密码等</p></li><li><p><strong>授权(Authorization)</strong>： 在信息安全领域是指资源所有者委派执行者，赋予执行者指定范围的资源操作权限，以便对资源的相关操作。</p><p>现实生活领域： 银行卡（由银行派发）、门禁卡（由物业管理处派发）、钥匙（由房东派发）</p><p>互联网领域： web 服务器的 session 机制、web 浏览器的 cookie 机制、颁发授权令牌（token）等</p></li><li><p><strong>鉴权(Authentication)</strong>： 在信息安全领域是指对于一个声明者所声明的身份权利，对其所声明的真实性进行<strong>鉴别确认</strong>的过程。授权和鉴权是两个上下游相匹配的关系，先授权，后鉴权。</p><p>现实生活领域： 门禁卡需要通过门禁卡识别器，银行卡需要通过银行卡识别器；</p><p>互联网领域： 校验 session/cookie/token 的合法性和有效性</p></li><li><p><strong>权限控制(Access/Permission Control)</strong>： 将可执行的操作定义为权限列表，然后判断操作是否允许/禁止
对于权限控制，可以分为两部分进行理解：一个是权限，另一个是控制。权限是抽象的逻辑概念，而控制是具体的实现方式。</p><p>现实生活领域： 门禁卡的权限</p><p>互联网领域： 通过 web 后端服务，控制接口访问，允许或拒绝访问请求</p></li></ul><h2 id=关系>关系</h2><p>前后依次发生</p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image1.png width=710 height=110 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image1_hu13559553354615734185.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image1_hu17935789042218794504.png 1024w" loading=lazy class=gallery-image data-flex-grow=645 data-flex-basis=1549px></p><p>使用门禁卡开门： 认证、授权、鉴权、权限控制四个环节一气呵成，在瞬间同时发生</p><p>用户的网站登录： 用户在使用用户名和密码进行登录时，认证和授权两个环节一同完成，而鉴权和权限控制则发生在后续的请求访问中，比如在选购物品或支付时。</p><h2 id=http基本鉴权>HTTP基本鉴权</h2><p>在 HTTP 中，<code>基本认证方案（Basic Access Authentication)</code> 是允许客户端（通常指的就是网页浏览器）在请求时，通过用户提供用户名和密码的方式，实现对用户身份的验证。</p><blockquote><p>几乎所有网站都不会使用此认证方案</p></blockquote><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image2.png width=823 height=784 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image2_hu3473888559170125803.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image2_hu7386557415302030120.png 1024w" loading=lazy alt=HTTP基本鉴权 class=gallery-image data-flex-grow=104 data-flex-basis=251px></p><h3 id=缺点>缺点</h3><ul><li>不安全</li><li>无法主动注销</li></ul><h2 id=session-cookie-鉴权>Session-Cookie 鉴权</h2><p><code>Session-Cookie</code> 认证是利用<strong>服务端</strong>的 Session和 <strong>客户端</strong> 的 Cookie 来实现的前后端通信认证模式。</p><h3 id=cookie>Cookie</h3><p><code>HTTP</code> 无状态（对于事务处理没有记忆能力，每次客户端和服务端会话完成时，服务端不会保存任何会话信息）</p><p>为了<strong>让服务器区分不同的客户端</strong>，服务端就必须主动的去维护一个状态，这个状态用于告知服务端前后两个请求是否来自同一浏览器。而这个状态可以通过 <code>Cookie</code> 去实现。</p><p><strong>特点：</strong></p><ul><li>存储在客户端，可随意篡改，不安全</li><li>有大小限制，最大为 4kb</li><li>有数量限制，一般一个浏览器对于一个网站只能存不超过 20 个 Cookie，浏览器一般只允许存放 300个 Cookie</li><li>Android 和 IOS 对 Cookie 支持性不好</li><li>不可跨域</li></ul><h3 id=session>Session</h3><p>无状态协议通信过程中，为了实现中断/继续操作，将用户和服务器之间的交互进行的一种抽象；</p><p>具体来说，是服务器生成的一种具有特定结构的数据，可以通过多种方式保存，如内存、数据库、文件等，大型网站一般有专门的 Session 服务器集群来保存用户会话</p><p><strong>原理流程：</strong></p><ol><li><strong>客户端：</strong> 用户向服务器首次发送请求；</li><li><strong>服务器：</strong> 接收到数据并自动为该用户创建特定的 Session / Session ID，来标识用户并跟踪用户当前的会话过程；</li><li><strong>客户端：</strong> 浏览器收到响应获取会话信息，并且会在下一次请求时带上 Session / Session ID；</li><li><strong>服务器：</strong> 服务器提取后会与本地保存的 Session ID进行对比找到该特定用户的会话，进而获取会话状态；</li><li>至此客户端与服务器的通信变成有状态的通信；</li></ol><p><strong>特点：</strong></p><ul><li>Session 保存在服务器上；</li><li>通过服务器自带的加密协议进行；</li></ul><p><strong>与 Cookie 的差异：</strong></p><ul><li><strong>安全性：</strong> Cookie 由于保存在客户端，可随意篡改，Session 则不同存储在服务器端，无法伪造，所以 Session 的安全性更高；</li><li><strong>存取值的类型不同：</strong> Cookie 只支持字符串数据，Session 可以存任意数据类型；</li><li><strong>有效期不同：</strong> Cookie 可设置为长时间保持，Session 一般失效时间较短；</li><li><strong>存储大小不同：</strong> Cookie 保存的数据不能超过 4K；</li></ul><blockquote><p><code>Session-Cookie</code> ：将 <code>Session</code> 存储在客户端的 <code>Cookie</code> 中</p></blockquote><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image3.png width=740 height=748 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image3_hu12580886088333893057.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image3_hu18391822153030641306.png 1024w" loading=lazy alt=Session-Cookie的认证流程图 class=gallery-image data-flex-grow=98 data-flex-basis=237px></p><p><strong>Pros</strong></p><ul><li>Cookie 简单易用</li><li>Session 数据存储在服务端，相较于 JWT 方便进行管理，也就是当用户登录和主动注销，只需要添加删除对应的 Session 就可以了，方便管理</li><li>只需要后端操作即可，前端可以无感等进行操作</li></ul><p><strong>Cons</strong></p><ul><li>依赖 Cookie(用户可能在浏览器端禁用 Cookie）</li><li>非常不安全，Cookie 将数据暴露在浏览器中，增加了数据被盗的风险（容易被 CSRF 等攻击）</li><li>Session 存储在服务端（Redis），增大了服务端的开销，用户量大的时候会大大降低服务器性能</li><li>对移动端的支持性不友好</li></ul><p><strong>前端常用库</strong></p><ul><li>使用 express：<a class=link href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fexpressjs%2Fsession" target=_blank rel=noopener>express-session</a></li><li>使用 koa：<a class=link href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fkoajs%2Fsession" target=_blank rel=noopener>koa-session</a></li></ul><h2 id=token-鉴权>Token 鉴权</h2><p>避免<code>Session-Cookie</code> 缺点</p><h3 id=token>Token</h3><p><code>Token</code> 是一个令牌，客户端访问服务器时，验证通过后服务端会为其签发一张令牌，之后，客户端就可以携带令牌访问服务器，服务端只需要验证令牌的有效性即可。</p><p>即：<strong>访问资源接口（API）时所需要的资源凭证</strong></p><p>一般 Token 的组成：<strong>uid</strong> (用户唯一的身份标识) + <strong>time</strong> (当前时间的时间戳) + <strong>sign</strong> (签名，Token 的前几位以哈希算法压缩成的一定长度的十六进制字符串)</p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image4.png width=952 height=784 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image4_hu15972041294992637371.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image4_hu15122191386625276378.png 1024w" loading=lazy alt=Token的认证流程图 class=gallery-image data-flex-grow=121 data-flex-basis=291px></p><p><strong>Pros</strong></p><ul><li><strong>服务端无状态化、可扩展性好：</strong> Token 机制在服务端不需要存储会话（Session）信息，因为 Token 自身包含了其所标识用户的相关信息，这有利于在多个服务间共享用户状态</li><li><strong>支持 APP 移动端设备；</strong></li><li><strong>安全性好：</strong> 有效避免 CSRF 攻击（因为不需要 Cookie）</li><li><strong>支持跨程序调用：</strong> 因为 Cookie 是不允许跨域访问的，而 Token 则不存在这个问题</li></ul><p><strong>Cons</strong></p><ul><li><strong>配合：</strong> 需要前后端配合处理；</li><li><strong>占带宽：</strong> 正常情况下比 <code>sid</code> 更大，消耗更多流量，挤占更多宽带</li><li><strong>性能问题：</strong> 虽说验证 Token 时不用再去访问数据库或远程服务进行权限校验，但是需要对 Token 加解密等操作，所以会更耗性能；</li><li><strong>有效期短：</strong> 为了避免 Token 被盗用，一般 Token 的有效期会设置的较短，需要 <code>Refresh Token</code></li></ul><h3 id=refresh-token>Refresh Token</h3><p>业务接口用来鉴权的 Token，称为 <code>Access Token</code>。</p><p>为了安全， <code>Access Token</code> 有效期一般设置较短，以避免被盗用。但过短的有效期会造成 <code>Access Token</code> 经常过期</p><p>解决办法：</p><ul><li>刷新 <code>Access Token</code>，让用户重新登录获取新 Token，会很麻烦；</li><li>引入一个专门生成 Access Token 的 Token，称为 <code>Refresh Token</code></li></ul><p><strong>区别</strong></p><ul><li><strong>Access Token：</strong> 用来访问业务接口，由于有效期足够短，盗用风险小，也可以使请求方式更宽松灵活；</li><li><strong>Refresh Token：</strong> 用来获取 Access Token，有效期可以长一些，通过独立服务和严格的请求方式增加安全性；由于不常验证，也可以如前面的 Session 一样处理；</li></ul><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image5.png width=1410 height=1084 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image5_hu2480722546649558050.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image5_hu762319525938261322.png 1024w" loading=lazy alt=RefreshToken的认证流程图 class=gallery-image data-flex-grow=130 data-flex-basis=312px></p><h3 id=与-session-cookie-的区别>与 Session-Cookie 的区别</h3><p><code>Session-Cookie</code> 和 <code>Token</code> 有很多类似的地方， <code>Token</code> 像是 <code>Session-Cookie</code> 的升级改良版，存在以下区别</p><ul><li><strong>存储地不同：</strong> Session 一般是存储在服务端；Token 是无状态的，一般由前端存储；</li><li><strong>安全性不同：</strong> Session 和 Token 并不矛盾，作为身份认证 Token 安全性比 Session 好，因为每一个请求都有签名还能防止监听以及重放攻击；</li><li><strong>支持性不同：</strong> Session-Cookie 认证需要靠浏览器的 Cookie 机制实现，如果遇到原生 NativeAPP 时这种机制就不起作用了，或是浏览器的 Cookie 存储功能被禁用，也是无法使用该认证机制实现鉴权的；而 Token 验证机制丰富了客户端类型。</li></ul><blockquote><p><strong>如果用户数据可能需要和第三方共享，或者允许第三方调用 API 接口，则应使用 Token</strong></p></blockquote><h2 id=jwtjson-web-token鉴权>JWT（JSON Web Token）鉴权</h2><p>服务端验证客户端发送过来的 Token 时，还需要查询数据库获取用户基本信息，然后验证 Token 是否有效</p><p>每次请求验证都要查询数据库，增加了查库带来的延迟等性能消耗；</p><p><strong>业界常用解决方案： <code>JWT</code></strong></p><h3 id=jwt>JWT</h3><p><code>JWT</code> 是 <code>Auth0</code> 提出的通过 <code>对 JSON 进行加密签名</code>来实现授权验证的方案</p><p>就是登录成功后将相关用户信息组成 JSON 对象，然后对这个对象进行某种方式的<code>加密</code>，返回给客户端； 客户端在下次请求时带上这个 Token； 服务端再收到请求时<code>校验 token 合法性</code>，其实也就是在校验请求的合法性。</p><p><strong>组成</strong></p><p>它是一个很长的字符串，中间用点（<code>.</code>）分隔成三个部分</p><ul><li><p><code>Header</code></p><p>通常包括两部分</p><ul><li>typ：代表 Token 的类型，这里使用的是 JWT 类型；</li><li>alg：使用的 Hash 算法，例如 HMAC SHA256 或 RSA.</li></ul></li><li><p><code>Payload</code></p><p>包含一些声明 Claim (实体的描述，通常是一个 User 信息，还包括一些其他的元数据) ，用来存放实际需要传递的数据</p><p>JWT 规定了7个官方字段：</p><ul><li>iss (issuer)：签发人</li><li>exp (expiration time)：过期时间</li><li>sub (subject)：主题</li><li>aud (audience)：受众</li><li>nbf (Not Before)：生效时间</li><li>iat (Issued At)：签发时间</li><li>jti (JWT ID)：编号</li></ul><p>除了官方字段，还可以在这个部分定义私有字段</p></li><li><p><code>Signature</code></p><p>Signature 部分是对前两部分的签名，<strong>防止数据篡改</strong>。</p><p>首先，需要指定一个密钥（secret）。这个密钥只有服务器才知道，不能泄露给用户。然后，使用 Header 里面指定的签名算法（默认是 HMAC SHA256）产生签名。</p></li></ul><p><strong>使用方式</strong></p><p>客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。</p><p>此后，客户端每次与服务器通信，都要带上这个 JWT。</p><p>可以把它放在 Cookie 里面自动发送，但是这样不能跨域，所以更好的做法是放在 HTTP 请求的头信息<code>Authorization</code>字段里面。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=w> </span><span class=k>Authorization</span><span class=p>:</span><span class=w> </span><span class=n>Bearer</span><span class=w> </span><span class=o>&lt;</span><span class=n>token</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image6.png width=1059 height=784 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image6_hu5688254978455873038.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image6_hu6429160439826583416.png 1024w" loading=lazy alt=JWT的认证流程图 class=gallery-image data-flex-grow=135 data-flex-basis=324px></p><p><strong>Pros</strong></p><ul><li>不需要在服务端保存会话信息（RESTful API 的原则之一就是无状态），所以易于应用的扩展，即信息不保存在服务端，不会存在 Session 扩展不方便的情况</li><li>JWT 中的 Payload 负载可以存储常用信息，用于信息交换，有效地使用 JWT，可以降低服务端查询数据库的次数</li></ul><p><strong>Cons</strong></p><ul><li><strong>加密问题：</strong> JWT 默认是不加密，但也是可以加密的。生成原始 Token 以后，可以用密钥再加密一次。</li><li><strong>到期问题：</strong> 由于服务器不保存 Session 状态，因此无法在使用过程中废止某个 Token，或者更改 Token 的权限。也就是说，一旦 JWT 签发了，在到期之前就会始终有效，除非服务器部署额外的逻辑。</li></ul><p><strong>前端常用库</strong></p><ul><li>使用 express：<a class=link href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fauth0%2Fexpress-jwt" target=_blank rel=noopener>express-jwt</a></li><li>使用 koa：<a class=link href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fkoajs%2Fjwt" target=_blank rel=noopener>koa-jwt</a></li></ul><h2 id=单点登录single-sign-on>单点登录（Single Sign On）</h2><p>避免大型系统内子系统的重复登录，只需要登录一次，就可以访问其他相互信任的应用系统</p><p>例如</p><ul><li>登录天猫，淘宝也会自动登录；</li><li>登录百度贴吧，百度网盘也会自动登录；</li></ul><h3 id=同域sso>同域SSO</h3><p>当百度网站存在两个相同主域名下的贴吧子系统 <code>tieba.baidu.com</code> 和网盘子系统 <code>pan.baidu.com</code> 时，以下为他们实现 SSO 的步骤：</p><ol><li><strong>客户端：</strong> 用户访问某个子系统时（例如 <code>tieba.baidu.com</code>），如果没有登录，则跳转至 SSO 认证中心提供的登录页面进行登录；</li><li><strong>服务端：</strong> 登录认证后，服务端把登录用户的信息存储于 Session 中，并且附加在响应头的 <code>Set-Cookie</code> 字段中，设置 Cookie 的 Domain 为 <code>.baidu.com</code> ；</li><li><strong>客户端</strong>：再次发送请求时，携带主域名 Domain 下的 Cookie 给服务器，此时服务端就可以通过该 Cookie 来验证登录状态了；</li></ol><p>亦即 <code>Session-Cookie 认证</code></p><h3 id=异域sso>异域SSO</h3><p>如天猫 (tmall.com) 和 淘宝 (taobao.com)</p><p>利用 <code>CAS(Central Authentication Service)</code>中央授权服务</p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image7.png width=2105 height=1552 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image7_hu11061096906380105898.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image7_hu4966443444307666041.png 1024w" loading=lazy alt=CAS认证流程图 class=gallery-image data-flex-grow=135 data-flex-basis=325px></p><ol><li><p><strong>客户端：</strong> 开始访问系统 A；</p></li><li><p><strong>系统 A：</strong> 发现用户未登录，重定向至 CAS 认证服务（sso.com），同时 URL 地址参数携带登录成功后回跳到系统 A 的页面链接</p></li><li><p><strong>CAS 认证服务：</strong> 发现请求 Cookie 中没有携带登录的票据凭证（TGC），所以 CAS 认证服务判定用户处于 <code>未登录</code> 状态，重定向用户页面至 CAS 的登录界面，用户在 CAS 的登录页面上进行登录操作。</p></li><li><p><strong>客户端：</strong> 输入用户名密码进行 CAS 系统认证；</p></li><li><p><strong>CAS 认证服务：</strong> 校验用户信息，并且 <code>生成 TGC</code> 放入自己的 Session 中，同时以 Set-Cookie 形式写入 Domain 为 <code>sso.com</code> 的域下 ；同时生成一个 <code>授权令牌 ST (Service Ticket)</code> ，然后重定向至系统 A 的地址，重定向的地址中包含生成的 ST</p></li><li><p><strong>系统 A：</strong> 拿着 ST 向 CAS 认证服务发送请求，CAS 认证服务验证票据 (ST) 的有效性。验证成功后，系统 A 知道用户已经在 CAS 登录了（其中的 ST 可以保存到 Cookie 或者本地中），系统 A 服务器使用该票据 (ST) 创建与用户的会话，称为局部会话，返回受保护资源；</p></li><li><p><strong>客户端：</strong> 开始访问系统 B；</p></li><li><p><strong>系统 B：</strong> 发现用户未登录，重定向至 SSO 认证服务，并将自己的地址作为参数传递，并附上在 sso.com 域下的 cookie 值是第五步生成的 TGC；</p></li><li><p><strong>CAS 认证服务：</strong> CAS 认证服务中心发现用户已登录，跳转回系统 B 的地址，并附上票据 (ST) ;</p></li><li><p><strong>系统 B：</strong> 拿到票据 (ST)，去 CAS 认证服务验证票据 (ST) 的有效性。验证成功后，客户端也可以跟系统 B 交往了 ~</p></li></ol><p><strong>注意</strong></p><ul><li>如图中流程所示，我们发现 <code>CAS 认证服务</code> 在签发的 <code>授权令牌 ST</code> 后，直接重定向，这样其实是比较容易容易被窃取，那么我们需要在系统 A 或者系统 B 在向 CAS 验证成功 (如图中的第 14 步和第 11 步) 后，再生成另一个新的验证 Token 返回给客户端保存；</li><li>CAS 一般提供四个接口：<ul><li><code>/login</code>：登录接口，用于登录到中央授权服务</li><li><code>/logout</code>：登出接口，用于从中央授权服务中登出</li><li><code>/validate</code>：用于验证用户是否登录中央授权服务</li><li><code>/serviceValidate</code>：用于让各个 Service 验证用户是否登录中央授权服务</li></ul></li><li>CAS 生成的票据：<ul><li><strong>TGT（Ticket Grangting Ticket）</strong> ：TGT 是 CAS 为用户签发的 <code>登录票据</code>，拥有了 TGT，用户就可以证明自己在 CAS 成功登录过。</li><li><strong>TGC：Ticket Granting Cookie：</strong> CAS Server 生成TGT放入自己的 Session 中，而 TGC 就是这个 Session 的唯一标识（SessionId），以 Cookie 形式放到浏览器端，是 CAS Server 用来明确用户身份的凭证。</li><li><strong>ST（Service Ticket）</strong> ：ST 是 CAS 为用户签发的访问某个 Service 的票据。</li></ul></li></ul><h2 id=oauth-20>OAuth 2.0</h2><p>是一种授权机制。数据的所有者告诉系统，同意授权第三方应用进入系统，获取这些数据。系统从而产生一个短期的进入令牌（Token），用来<strong>代替密码</strong>，供第三方应用使用。</p><p><strong>令牌与密码的差异：</strong></p><p><code>令牌（Token）</code> 与 <code>密码（Password）</code> 的作用是一样的，都可以进入系统，但是有三点差异。</p><ol><li><strong>令牌是短期的，到期会自动失效：</strong> 用户自己无法修改。密码一般长期有效，用户不修改，就不会发生变化。</li><li><strong>令牌可以被数据所有者撤销，会立即失效。</strong></li><li><strong>令牌有权限范围（scope）：</strong> 对于网络服务来说，只读令牌就比读写令牌更安全。密码一般是完整权限。</li></ol><p>OAuth 2.0 对于如何颁发令牌的细节，规定得非常详细。具体来说，一共分成<strong>四种授权</strong>模式 <strong>（Authorization Grant）</strong> ，适用于不同的互联网场景。</p><p>无论哪个模式都拥有三个必要角色：<code>客户端</code>、<code>授权服务器</code>、<code>资源服务器</code>，有的还有<code>用户（资源拥有者）</code>。</p><h3 id=授权码模式authorization-code-grant>授权码模式（Authorization Code Grant)</h3><p><code>授权码（Authorization Code Grant)</code> 方式，指的是第三方应用先申请一个授权码，然后再用该码获取令牌。</p><p>这种方式是最常用的流程，安全性也最高，它适用于那些<strong>有后端服务</strong>的 Web 应用。授权码通过前端传送，令牌则是储存在后端，而且所有与资源服务器的通信都在后端完成。这样的前后端分离，可以避免令牌泄漏。</p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image8.png width=1163 height=544 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image8_hu854464973042450006.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image8_hu2535573060198864967.png 1024w" loading=lazy class=gallery-image data-flex-grow=213 data-flex-basis=513px></p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image9.png width=1014 height=436 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image9_hu10544492372680657281.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image9_hu1455252232332669329.png 1024w" loading=lazy class=gallery-image data-flex-grow=232 data-flex-basis=558px></p><h3 id=隐藏式模式implicit-grant>隐藏式模式（Implicit Grant）</h3><p>有些 Web 应用是纯前端应用，没有后端。这时就不能用上面的方式了，必须将令牌储存在前端。<strong>OAuth2.0 就规定了第二种方式，允许直接向前端颁发令牌。这种方式没有授权码这个中间步骤，所以称为（授权码）&ldquo;隐藏式&rdquo;（implicit）。</strong></p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image10.png width=1032 height=436 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image10_hu2432115526238567982.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image10_hu73720935055352426.png 1024w" loading=lazy class=gallery-image data-flex-grow=236 data-flex-basis=568px></p><h3 id=用户名密码式模式password-credentials-grant>用户名密码式模式（Password Credentials Grant）</h3><p>如果你高度信任某个应用，OAuth 2.0 也允许用户把用户名和密码，直接告诉该应用。该应用就使用你的密码，申请令牌，这种方式称为"密码式"（password）</p><h3 id=客户端模式client-credentials-grant>客户端模式（Client Credentials Grant）</h3><p>客户端模式指客户端以自己的名义，而不是以用户的名义，向<code>授权服务器</code> 进行认证。</p><p>主要适用于没有前端的命令行应用。</p><h3 id=选型>选型</h3><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image11.png width=899 height=450 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image11_hu11901582504919261065.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image11_hu12536369338648287890.png 1024w" loading=lazy class=gallery-image data-flex-grow=199 data-flex-basis=479px></p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image12.png width=1319 height=404 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image12_hu14505064976910495080.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image12_hu17893566117700106231.png 1024w" loading=lazy class=gallery-image data-flex-grow=326 data-flex-basis=783px></p><h2 id=联合登录和信任登录>联合登录和信任登录</h2><p><strong>联合登录</strong></p><p>指同时包含多种凭证校验的登录服务，同时，也可以理解为使用第三方凭证进行校验的登录服务。</p><p><strong>example：</strong> 对于两个网站 A 和 B，在登录 A 网站的时候用 B 网站的帐号密码，或者登录 B 网站的时候使用 A 网站的帐号密码</p><p>这样的概念其实与上面所讲的 OAuth2.0 的 <code>用户名密码式模式</code> 认证方式类似。</p><p>最经典的莫过于 APP 内嵌 H5 的使用场景，当用户从 APP 进入内嵌的 H5 时，我们希望 APP 内已登录的用户能够访问到 H5 内受限的资源，而未登录的用户则需要登录后访问。</p><p>这里思路主要有两种，一种是原生跳转内嵌 H5 页面时，将登录态 Token 附加在 URL 参数上，另一种则是内嵌 H5 主动通过与原生客户端制定的协议获取应用内的登录状态。</p><p><strong>信任登录</strong></p><p>指所有不需要用户主动参与的登录，例如建立在私有设备与用户之间的绑定关系，凭证就是私有设备的信息，此时不需要用户再提供额外的凭证。信任登录又指用第三方比较成熟的用户库来校验凭证，并登录当前访问的网站。</p><p><strong>example：</strong> 在 A 网站有登录状态的时候，可以直接跳转到 B 网站而不用登录，就是 <code>信任登录</code>。</p><p>目前比较常见的第三方信任登录帐号如：QQ 号淘宝帐号、支付宝帐号、微博帐号等。</p><p>不难发现 OAtuth 2.0 其实就是信任登录的缩影，因为正是有了OAuth，我们的信任登录才得以实现。</p><h2 id=唯一登录>唯一登录</h2><p>实现用户只能在一个设备上登录，禁止用户重复登录</p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image13.png width=2088 height=1444 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image13_hu4112674547769910547.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image13_hu9663016455399857186.png 1024w" loading=lazy alt=唯一登录流程图 class=gallery-image data-flex-grow=144 data-flex-basis=347px></p><h2 id=扫码登录>扫码登录</h2><p>无需在网页上输入任何账号和密码，只需要让移动端 APP (如微信、淘宝、QQ等等) 中已登录用户主动扫描 <code>二维码</code> ，再确认登录，以使 PC 端的同款应用得以快速登录，需要三端 (<code>PC端</code>、<code>手机端</code>、<code>服务端</code>) 来进行配合才能达到登录成功的效果</p><p><strong>二维码</strong></p><p><code>二维码</code> 又称二维条码，常见的二维码为 QR Code，QR 全称 Quick Response，是一个近几年来移动设备上超流行的一种编码方式，它比传统的Bar Code条形码能存更多的信息，也能表示更多的数据类型。</p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image14.png width=1692 height=1252 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image14_hu10002049440793259386.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image14_hu11096625206206538180.png 1024w" loading=lazy class=gallery-image data-flex-grow=135 data-flex-basis=324px></p><h2 id=一键登录适用于原生app>一键登录（适用于原生APP）</h2><p><strong>传统账号密码登录缺点</strong></p><ol><li>要求用户要记住自己的账号和密码，存在记忆成本。用户为了降低记忆成本，很可能会在不同平台使用同一套账号密码。从安全角度考虑，一旦某个平台的账号密码泄露了，会连累到该用户使用的其他平台。</li><li>账号和个人身份无关，意味着同一个用户可以注册多个不同的账号，可能出现恶意注册情况。</li></ol><p>随着无线互联的发展以及手机卡实名制的推广，手机号俨然已成为特别的身份证明，与账号密码相比，手机号可以更好地验证用户的身份，防止恶意注册。</p><p>但是手机号注册还是需要一系列繁琐的操作：输入手机号、等待短信验证码、输入验证码、点击登录。整个流程少说二十秒，而且如果收不到短信，也就登录补了，这类问题有可能导致潜在的用户流失。</p><p>从安全角度考虑，还存在验证码泄漏的风险。如果有人知道了你的手机号，并且窃取到了验证码，那他也能登录你的账号了。</p><p><strong>一键登录。</strong></p><p>直接获取到当前手机使用的手机卡号进行登录</p><p>取决于运营商是否开放相关服务；随着运营商开放了相关的服务，我们现在已经能够接入运营商提供的 SDK 并付费使用相关的服务</p><p><img src=/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image15.png width=939 height=974 srcset="/p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image15_hu14933120766367110633.png 480w, /p/%E9%89%B4%E6%9D%83authentication%E6%A6%82%E8%A7%88/image15_hu11771756313670640539.png 1024w" loading=lazy alt=authentication-one-click-login-workflow class=gallery-image data-flex-grow=96 data-flex-basis=231px></p><p><strong>三大运营商开放平台：</strong></p><ul><li><a class=link href=https://dev.10086.cn/ target=_blank rel=noopener>移动 - 互联网能力开放平台</a></li><li><a class=link href=https://id.dlife.cn/portal/index.html#/ target=_blank rel=noopener>电信 - 天翼账号开放平台</a></li><li><a class=link href=https://open.wo.com.cn/ target=_blank rel=noopener>联通 - WO+ 开放平台</a></li></ul><p>由于国内三大运营商各自有独立的 SDK，所以会导致兼容方面的工作会特别繁琐。如果要采用一键登录的方案，不妨采用第三方提供了号码认证服务，下列几家供应商都拥有手机号码认证能力：</p><ul><li><a class=link href=https://help.aliyun.com/zh/pnvs/ target=_blank rel=noopener>阿里 - 号码认证服务</a></li><li><a class=link href=http://shanyan.253.com/ target=_blank rel=noopener>创蓝 - 闪验</a></li><li><a class=link href=https://www.jiguang.cn/identify target=_blank rel=noopener>极光 - 极光认证</a></li><li><a class=link href=https://www.mob.com/mobService/secverify target=_blank rel=noopener>mob - 秒验</a></li></ul><p><strong>注意：</strong></p><p>在认证过程中，需要用户打开蜂窝网络，如果手机设备没有插入 SIM 卡、或者关闭蜂窝网络的情况下，是无法完成认证的。所以就算接入一键登录，还是要兼容传统的登录方式，允许用户在失败的情况下，仍能正常完成登录流程。</p><h2 id=总结>总结</h2><p><code>HTTP 基本认证</code>适用于内部网络，或者对安全要求不是很高的网络；</p><p><code>Session-Cookie</code> 适用于一般中大型的网站（移动端 APP 除外）；</p><p><code>Token</code> 和 <code>JWT</code> 都适用于市面上大部分的企业型网站，JWT 效能会优于 Token；</p><p><code>单点登录</code> 适用于子系统较多的大型企业网站；</p><p><code>OAuth 2.0</code>适用于需要快速注册用户型的网站；</p><p><code>扫码登录</code> 适用于已完成部署了三端的企业；</p><p><code>一键登录</code> 适用于原生 APP；</p></section><footer class=article-footer><section class=article-tags><a href=/tags/authentication/>Authentication</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Nov 09, 2022 00:00 UTC</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E6%A6%82%E8%BF%B0/><div class=article-details><h2 class=article-title>【知识图谱】概述</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 飞鸿踏雪泥</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>