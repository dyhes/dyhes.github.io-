<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Link\nSpring boot Spring Boot is an open source extension of the Spring Framework designed to simplify the Spring application development.\nSpring Boot was introduced as a subproject under the Spring Framework to empower developers with a fast startup experience and exempt them from most of the configuration hazards.\nIt provides an additional layer between the Spring Framework for the user to simplify certain configuration aspects.\nA Spring Boot web application can be either Servlet-based or reactive type.\n"><title>【Spring Boot in practice】Notes</title>
<link rel=canonical href=https://dyhes.github.io/p/spring-boot-in-practicenotes/><link rel=stylesheet href=/scss/style.min.6aa4d43a5cae1c51ef34b3f851ae7421f4b2f2d13827e2d975acbeb4f13c8710.css><meta property='og:title' content="【Spring Boot in practice】Notes"><meta property='og:description' content="Link\nSpring boot Spring Boot is an open source extension of the Spring Framework designed to simplify the Spring application development.\nSpring Boot was introduced as a subproject under the Spring Framework to empower developers with a fast startup experience and exempt them from most of the configuration hazards.\nIt provides an additional layer between the Spring Framework for the user to simplify certain configuration aspects.\nA Spring Boot web application can be either Servlet-based or reactive type.\n"><meta property='og:url' content='https://dyhes.github.io/p/spring-boot-in-practicenotes/'><meta property='og:site_name' content='飞鸿踏雪泥'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Spring Boot'><meta property='article:published_time' content='2024-07-02T00:00:00+00:00'><meta property='article:modified_time' content='2024-07-02T00:00:00+00:00'><meta name=twitter:title content="【Spring Boot in practice】Notes"><meta name=twitter:description content="Link\nSpring boot Spring Boot is an open source extension of the Spring Framework designed to simplify the Spring application development.\nSpring Boot was introduced as a subproject under the Spring Framework to empower developers with a fast startup experience and exempt them from most of the configuration hazards.\nIt provides an additional layer between the Spring Framework for the user to simplify certain configuration aspects.\nA Spring Boot web application can be either Servlet-based or reactive type.\n"><link rel="shortcut icon" href=/github.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu17834253352308399148.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>飞鸿踏雪泥</a></h1><h2 class=site-description>没有记录，就没有发生</h2></div></header><ol class=menu-social><li><a href=https://github.com/dyhes target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:dyheslin@gmail.com target=_blank title=Gmail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-gmail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16 20h3a1 1 0 001-1V5a1 1 0 00-1-1h-3v16z"/><path d="M5 20h3V4H5A1 1 0 004 5v14a1 1 0 001 1z"/><path d="M16 4l-4 4-4-4"/><path d="M4 6.5l8 7.5 8-7.5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/categories/><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#spring-boot>Spring boot</a><ol><li><a href=#components>Components</a></li><li><a href=#lombok>Lombok</a></li><li><a href=#pojo>POJO</a></li><li><a href=#record>Record</a></li><li><a href=#pomxml-file>pom.xml file</a></li><li><a href=#applicationpropertiesfile>application.properties file</a></li><li><a href=#war-vs-ear>WAR vs EAR</a></li><li><a href=#java-bean>Java Bean</a></li><li><a href=#springbootapplication>@SpringBootApplication</a></li><li><a href=#spring-component>Spring Component</a></li><li><a href=#run-method>run() method</a></li></ol></li><li><a href=#spring-data>Spring Data</a></li><li><a href=#spring-security>Spring Security</a><ol><li><a href=#authentication>Authentication</a><ol><li><a href=#usernamepassword-authentication>⠀Username/Password Authentication</a></li><li><a href=#persistence><strong>Persistence</strong></a></li></ol></li></ol></li><li><a href=#restful-api>Restful API</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/millet/ style=background-color:#673424;color:>千钟粟
</a><a href=/categories/willow/ style=background-color:#dc9123;color:>满城风絮</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/spring-boot-in-practicenotes/>【Spring Boot in practice】Notes</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 02, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>22 minute read</time></div></footer></div></header><section class=article-content><p><a class=link href="https://reader-service.fcdn.sk/?source=3c6b6838ceb712e38b66a0ca2cde230f44274dac2f09fba71ffdc61842816357&amp;download_location=https%3A%2F%2Fsinglelogin.re%2Fdl%2F21754907%2F994075" target=_blank rel=noopener>Link</a></p><h2 id=spring-boot>Spring boot</h2><p>Spring Boot is an open source extension of the Spring Framework designed to simplify the Spring application development.</p><p>Spring Boot was introduced as a subproject under the Spring Framework to empower developers with a fast startup experience and exempt them from most of the configuration hazards.</p><p>It provides an additional layer between the Spring Framework for the user to simplify certain configuration aspects.</p><p>A Spring Boot web application can be either Servlet-based or reactive type.</p><h3 id=components>Components</h3><ul><li><p>spring-boot</p><p>This is the <strong>primary</strong> Spring Boot component that provides support to other components. For example, it contains the <strong>SpringApplication class</strong>, which contains several static methods to create a standalone Spring Boot application. It also provides support for embedded web servers (e.g., Tomcat) and supports externalized application configurations (e.g., database details of your application), etc.</p></li><li><p>spring-boot-autoconfigure</p></li><li><p>Spring-boot-starters</p></li><li><p>spring-boot-actuator</p><p>In the context of software, particularly within the Spring Boot framework, “Actuator” refers to a set of tools and features that provide insights into the application’s runtime behavior and health.</p></li><li><p>spring-boot-actuator-autoconfigure</p></li><li><p>spring-boot-loader</p><p>This component allows a Spring Boot application to be packaged as a single fat JAR file, including all dependencies and the embedded web servers that can be run standalone. You don’t use this module independently; instead, it is used along with Maven or Gradle plugins</p></li><li><p>spring-boot-devtools</p></li></ul><h3 id=lombok>Lombok</h3><p><a class=link href=https://projectlombok.org/ target=_blank rel=noopener>Lombok</a> is a Java library that automatically generates the constructors, getter, setter, toString, and others based on the presence of a few annotations in the plain old Java object (POJO) class.</p><h3 id=pojo>POJO</h3><p>A Plain Old Java Object (POJO) is a simple Java object that does not adhere to any special rules or conventions beyond those required by the Java Language Specification. The term is used to emphasize that these objects are free from the constraints typically imposed by more complex frameworks or libraries.</p><h3 id=record>Record</h3><p>Java 14 has introduced the concept of records in the Java language. Records are immutable data classes that require you to specify only the type and name of the fields. The Java compiler can then generate the equals, hashCode, and toString methods. It also generates the private final fields, getter methods, and public constructor.</p><h3 id=pomxml-file>pom.xml file</h3><p>The pom.xml file is a fundamental component of a Maven-based Java project. Maven is a build automation tool used primarily for Java projects, and pom.xml (Project Object Model) is the configuration file that defines the project’s dependencies, build configuration, and other project-specific settings.</p><h3 id=applicationpropertiesfile>application.properties file</h3><p>The application.properties file is a key configuration file used in Spring Boot applications. It allows developers to define various settings and configurations for the application in a simple and readable format. </p><h3 id=war-vs-ear>WAR vs EAR</h3><p>In general, to run a web application, you build and package the application components in a WAR or EAR archive file and deploy it into a web (e.g., Apache Tomcat) or application server (e.g., Red Hat JBoss). Spring Boot simplifies this process to a certain degree. It does not enforce you to build a WAR or EAR file of your application. Instead, it lets you run the Spring Boot application like a regular Java application using a conventional main() method.</p><h3 id=java-bean>Java Bean</h3><p>A JavaBean is a reusable software component that follows <strong>specific conventions</strong> defined by the JavaBeans specification. JavaBeans are used for <strong>encapsulating many objects into a single object</strong> (the bean), so they can be passed around as a single bean object.</p><p><strong>1 Default Constructor:</strong></p><p>A JavaBean must have a no-argument (default) constructor. This allows the bean to be easily instantiated.</p><p><strong>2</strong> <strong>Properties:</strong></p><p>Properties are private fields that are accessed and modified through public getter and setter methods.</p><p><strong>3</strong> <strong>Serializable:</strong></p><p>A JavaBean should implement the Serializable interface to allow its state to be saved and restored.</p><p><strong>4</strong> <strong>Accessor Methods:</strong></p><p>Getter and setter methods follow a specific naming convention (getPropertyName for getters and setPropertyName for setters).
The “Bean” part of the term is a metaphor borrowed from the agricultural sense of the word, implying something small, lightweight, and reusable.</p><h3 id=springbootapplication>@SpringBootApplication</h3><p>@SpringBootApplication annotation is a convenient annotation that consists of three annotations:</p><ul><li><p>@EnableAutoConfiguration</p><p>provides the necessary support for Spring Boot to autoconfigure your application based on the JAR dependencies present in the application
classpath</p></li><li><p>@ComponentScan</p><p>Provides support to scan the packages for Spring components in the application.</p></li></ul><h3 id=spring-component>Spring Component</h3><p><strong>A component in Spring is a Java bean that is managed by Spring</strong> and annotated with the <strong>@Component, @Bean, or specialized component annotations</strong>. With the presence of @ComponentScan annotation, the Spring Boot application scans for all components present in the <strong>root package and sub-packages</strong> under it to manage their lifecycle. The key point to remember with ComponentScan is that the scan starts from a root package and continues to all child packages. Thus, if you have packages that are not in the root or its sub-package, none of those components will be scanned by the component scan.</p><ul><li>@SpringBootConfiguration
This annotation indicates that <strong>the annotated class provides the Spring Boot application configuration</strong>. It is meta-annotated with Spring @Configuration annotation so that the configurations in the annotated class can be found automatically by Spring Boot. Thus, the beans defined in this main class can be autodetected and loaded by Spring.</li></ul><h3 id=run-method>run() method</h3><p>Most of the time, you’ll use the static run() method of SpringApplication to bootstrap and launch your application. Spring Boot performs several activities while it executes the run() method:</p><p><strong>1</strong> <strong>Creates an instance of an</strong> <strong>ApplicationContext</strong> based on the libraries present in the classpath.</p><p><strong>2</strong> <strong>Registers a</strong> <strong>CommandLinePropertySource</strong> to expose command line arguments as Spring properties.</p><p><strong>3</strong> <strong>Refreshes the</strong> <strong>ApplicationContext</strong> created at step 1 to load all singleton beans.</p><p><strong>4</strong> <strong>Triggers the</strong> <strong>ApplicationRunners</strong> <strong>and</strong> <strong>CommandRunners</strong> configured in the application.</p><p>Most Java applications you develop consist of objects. These objects interact with each other, and there are dependencies among them. To effectively manage object creation and interdependencies, Spring uses the principles of <strong>dependency injection (DI)</strong>.
This dependency injection or the <strong>inversion of control (IoC)</strong> approach lets Spring create the objects (or, more appropriately, the <strong>beans</strong> in Spring parlance) and inject the dependencies externally.
The bean definitions are presented to Spring either through the <strong>XML bean definition files</strong> (e.g., applicationContext.xml) or through the annotation-based configurations (@Configuration annotation). Spring loads these bean definitions and keeps them available in the <strong>Spring IoC container</strong>. The ApplicationContext interface acts as the <strong>Spring IoC Container</strong>. Spring provides a plethora of ApplicationContext implementations based on the application type (Servlet or Reactive application), the bean definition configurations (e.g., to load from classpath or annotation), and so on.</p><p>Although @EventListener works well in most circumstances, it does not work for events that are published very early in the application start-up, such as ApplicationStartingEvent and ApplicationEnvironmentPreparedEvent.</p><p>By default, Spring Boot reads the application.properties or application.yml file from the following locations:</p><p>1 The classpath root</p><p>2 The classpath /config package</p><p>3 The current directory</p><p>4 The /config subdirectory in the current directory</p><p>5 Immediate child directories of the /config subdirectory</p><p>You can maintain the profile-specific property files with the application-{profile}.properties (or .yml) file.
You can activate a profile (e.g., dev or test) using the spring.profiles.active Spring Boot property.</p><p>1 The application properties (properties or the YAML file) packaged inside the application JAR
2 Profile-specific application properties packaged inside the application JAR
3 The application properties (properties or the YAML file) packaged outside the application JAR
4 Profile-specific application properties packaged outside the application JAR</p><p>Following is the order in which properties get precedence. The higher sequence number overrides the properties of the lower sequence number:
1 SpringApplication
2 @PropertySource
3 Config data file
4 OS environment variable
5 Command line arguments</p><p>Both @Bean and @Component annotations let you <strong>instruct Spring to create instances</strong> of the annotated class, but their usage is slightly different. You typically use the @Bean annotation for the classes for which <strong>you don’t have access to the source code</strong>. Thus, you define a bean and return a new instance of the class. For the @Component annotation, as you have access to the source Java file, you can simply annotate the class with this annotation.Both @Bean and @Component annotations let you instruct Spring to create instances of the annotated class, but their usage is slightly different. You typically use the @Bean annotation for the classes for which you don’t have access to the source code. Thus, you define a bean and return a new instance of the class. For the @Component annotation, as you have access to the source Java file, you can simply annotate the class with this annotation.</p><p>The CommandLineRunner is a useful feature that is frequently used to perform several application initialization activities. In a CommandLineRunner implementation, you also have access to the command line arguments through the args parameter.</p><p>Bean Validation, part of the Java EE (Enterprise Edition) specification, is a framework that provides a standard way to enforce constraints on the properties of JavaBeans. These constraints ensure that the data within beans meets certain criteria before it is processed or persisted. </p><p>Java annotations are a powerful feature introduced in <strong>Java 5</strong> that provide a way to add <strong>metadata</strong> to Java code. They can be applied to various elements of the code, including classes, methods, fields, parameters, and more. Annotations <strong>do not change</strong> the action of the compiled program but can be used by the compiler and runtime tools to <strong>generate code, analyze code, and perform other tasks</strong>.</p><h2 id=spring-data>Spring Data</h2><p><a class=link href=https://spring.io/projects/spring-data target=_blank rel=noopener>Spring Data</a> lets you access data from a variety of data sources (e.g., relational and nonrelational databases, MapReduce databases, and cloud-based data services). It attempts to provide a uniform, easy-to-use, and familiar programming model through the Spring Framework.</p><p>It is an umbrella project under the Spring Framework that contains several sub-projects, each of which targets a specific database. For instance, the <strong>Spring Data JPA module is specific to relational databases</strong> (e.g., H2, MySQL, PostgreSQL). Similarly, Spring Data MongoDB aims to provide support for the MongoDB database.</p><p>Java Database Connectivity (JDBC) is a <strong>standard API</strong> provided by Java that allows Java applications to interact with relational databases in a vendor-independent manner. JDBC provides a set of interfaces and classes that enable developers to connect to a database, execute SQL queries, and retrieve results. It serves as a bridge between Java applications and various database management systems (DBMS).</p><p>Java Persistence API (JPA) is <strong>a specification for object-relational mapping</strong> (ORM) in Java, which allows developers to manage relational data in Java applications using an object-oriented paradigm. JPA provides a standard way to map Java objects to database tables and to manage persistent data in applications.</p><ul><li><strong>JDBC:</strong><ul><li>JDBC is a <strong>low-level</strong> API for interacting with relational databases. It provides a set of interfaces and classes for connecting to a database, executing SQL queries, and retrieving results. JDBC is database-centric and requires developers to write SQL queries and manage the mapping between Java objects and database tables <strong>manually</strong>.</li></ul></li><li><strong>JPA:</strong><ul><li>JPA is a <strong>high-level</strong> API for object-relational mapping (ORM). It abstracts the database interactions and <strong>allows developers to work with Java objects instead of SQL queries</strong>. JPA automatically maps Java objects to database tables and handles CRUD (Create, Read, Update, Delete) operations, making it easier to manage persistent data in an object-oriented way.
JPA itself is not an implementation but a set of guidelines implemented by various ORM frameworks like <strong>Hibernate</strong>, EclipseLink, and <strong>Spring Data JPA</strong>.
Hibernate is the default JPA provider in Spring Data JPA.</li></ul></li></ul><p>MyBatis is a persistence framework that offers SQL mapping. It emphasizes direct SQL use, providing a higher degree of control over SQL queries and their execution. Unlike traditional ORM frameworks, <strong>MyBatis does not map Java objects to database tables but rather maps SQL statements to Java methods</strong>.</p><p>One of the core themes of Spring Data is to provide a <strong>consistent</strong> programming model
to access various data sources.</p><p>Spring Data provides a <strong>repository abstraction layer</strong> across the supported databases as a common programming model. The abstraction is contained in the Spring Data Commons module, and it provides several useful interfaces that let you perform the standard create, read, update, and delete (CRUD) operations as well as executing queries. This abstraction layer is the topmost layer and acts as the foundation for other Spring Data modules.</p><p><img src=/image%202.png loading=lazy></p><p>As part of the database configuration, Spring Boot automatically configures the <a class=link href=https://github.com/brettwooldridge/HikariCP target=_blank rel=noopener>HikariCP</a> database connection pool. A database connection pool contains one or more database connections that are generally created at the time of application startup and available for use by the application.
The benefit of a database connection pool is that a set of database connections are created at the application startup and available for use by the application. Thus, you don’t create a new connection each time you need a database connection and close it once done. The application can take a connection from the pool, use it, and return to the pool. Spring Boot uses HikariCP as the default database connection pool library.
<img src=/image%203.png loading=lazy></p><p>Spring Boot can load the SQL scripts from the classpath (e.g., the src/main/resources folder) or a preconfigured location. By default, you define the schema.sql file to provide all DDL scripts and define the data.sql file to include the DML scripts and place them inside the src/main/resources folder for Spring Boot to detect and execute these files.
To begin with, if you are using a database other than an embedded (in-memory) database, you need to set spring.sql.init.mode to always in the application.properties file.
In this schema initialization-based approach, Spring Boot re-creates the schema each time you restart the application. There is no database schema versioning done by Spring Boot.</p><p>In this schema initialization-based approach, Spring Boot re-creates the schema each time you restart the application. There is no database schema versioning done by Spring Boot.
In addition to the schema.sql and data.sql files, Spring Boot also supports database-specific SQLs. For instance, if your application supports multiple database types, and there are SQL syntax differences, you can use schema-${platform}.sql and data-${platform}.sql files.</p><p>Spring Data uses this marker interface Repository as the primary abstraction for a data source.
<img src=/image%204.png loading=lazy>
In addition to the CrudRepository, Spring Data also provides a PagingAndSortingRepository, which extends the CrudRepository and provides additional support for pagination and sorting of the entities.</p><p>@Entity marks a java class as a jpa entity
@Table provides the database table details
@Column provides mapping information between the Java fields and the associated column name in the table.
@Repository marks a class as a spring repository</p><h2 id=spring-security>Spring Security</h2><p>The following part comes from spring security official website
Spring Security provides comprehensive support for <a class=link href=https://en.wikipedia.org/wiki/Authentication target=_blank rel=noopener>authentication</a>. Authentication is how we <strong>verify the identity</strong> of who is trying to access a particular resource.</p><p>Spring Security’s PasswordEncoder interface is used to perform a one-way transformation of a password to let the password be stored securely.</p><p>To mitigate the effectiveness of Rainbow Tables, developers were encouraged to use salted passwords.</p><p>Adaptive one-way functions:
Can be adjusted to require more computational resources as hardware improves
Examples of adaptive one-way functions that should be used include <a class=link href=https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-bcrypt target=_blank rel=noopener>bcrypt</a>, <a class=link href=https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-pbkdf2 target=_blank rel=noopener>PBKDF2</a>, <a class=link href=https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-scrypt target=_blank rel=noopener>scrypt</a>, and <a class=link href=https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html#authentication-password-storage-argon2 target=_blank rel=noopener>argon2</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>PasswordEncoder</span><span class=w> </span><span class=n>passwordEncoder</span><span class=w> </span><span class=o>=</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PasswordEncoderFactories</span><span class=p>.</span><span class=na>createDelegatingPasswordEncoder</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></div><p>DelegatingPasswordEncoder Storage Format</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{id}encodedPassword
</span></span><span class=line><span class=cl>e.g. 
</span></span><span class=line><span class=cl>{bcrypt}$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM/BG
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>UserDetails</span><span class=w> </span><span class=n>user</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>withDefaultPasswordEncoder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>.</span><span class=na>username</span><span class=p>(</span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>.</span><span class=na>password</span><span class=p>(</span><span class=s>&#34;password&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>.</span><span class=na>roles</span><span class=p>(</span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>user</span><span class=p>.</span><span class=na>getPassword</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// {bcrypt}$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM/BG</span><span class=w>
</span></span></span></code></pre></div><p>Spring Security provides comprehensive support for <a class=link href=https://en.wikipedia.org/wiki/Authorization target=_blank rel=noopener>authorization</a>. Authorization is <strong>determining who is allowed</strong> to access a particular resource. Spring Security provides <a class=link href=https://en.wikipedia.org/wiki/Defense_in_depth_%28computing%29 target=_blank rel=noopener>defense in depth</a> by allowing for request based authorization and method based authorization.</p><p>Prevent CSRF (cross site request forgery)</p><ul><li>Synchronizer token request</li><li>Samesite attribute
Spring Security does not directly control the creation of the session cookie, so it does not provide support for the SameSite attribute. <a class=link href=https://spring.io/projects/spring-session target=_blank rel=noopener>Spring Session</a> provides support for the SameSite attribute in servlet-based applications. 
<strong>Safe Methods Must be Read-only</strong>
For <a class=link href=https://docs.spring.io/spring-security/reference/features/exploits/csrf.html#csrf-protection target=_blank rel=noopener>either protection</a> against CSRF to work, the application must ensure that <a class=link href=https://tools.ietf.org/html/rfc7231#section-4.2.1 target=_blank rel=noopener>&ldquo;safe&rdquo; HTTP methods are read-only</a>. This means that requests with the HTTP GET, HEAD, OPTIONS, and TRACE methods should not change the state of the application.</li></ul><p>Default Security Headers</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>Cache-Control: no-cache, no-store, max-age=0, must-revalidate
</span></span></span><span class=line><span class=cl><span class=err>Pragma: no-cache
</span></span></span><span class=line><span class=cl><span class=err>Expires: 0
</span></span></span><span class=line><span class=cl><span class=err>X-Content-Type-Options: nosniff
</span></span></span><span class=line><span class=cl><span class=err>Strict-Transport-Security: max-age=31536000 ; includeSubDomains(https only)
</span></span></span><span class=line><span class=cl><span class=err>X-Frame-Options: DENY
</span></span></span><span class=line><span class=cl><span class=err>X-XSS-Protection: 0
</span></span></span></code></pre></div><p>Spring Security provides <strong>Spring Data integration</strong> that allows referring to the current user within your queries. It is not only useful but necessary to include the user in the queries to support paged results since filtering the results afterwards would not scale.</p><p>In most environments, Security is stored on a per Thread basis. This means that when work is done on a new Thread, the SecurityContext is lost. Spring Security provides some infrastructure to help make this much easier for users. Spring Security provides low level abstractions for working with Spring Security in multi-threaded environments. </p><p>The default arrangement of Spring Boot and Spring Security affords the following behaviors at runtime:</p><ul><li>Requires an authenticated user <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authorization/authorize-http-requests.html target=_blank rel=noopener>for any endpoint</a> (including Boot’s /error endpoint)</li><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/user-details-service.html target=_blank rel=noopener>Registers a default user</a> with a generated password at startup (the password is logged to the console; in the preceding example, the password is 8e557245-73e2-4286-969a-ff57fe326336)</li><li>Protects <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/password-encoder.html target=_blank rel=noopener>password storage with BCrypt</a> as well as others</li><li>Provides form-based <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html target=_blank rel=noopener>login</a> and <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/logout.html target=_blank rel=noopener>logout</a> flows</li><li>Authenticates <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html target=_blank rel=noopener>form-based login</a> as well as <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/basic.html target=_blank rel=noopener>HTTP Basic</a></li><li>Provides content negotiation; for web requests, redirects to the login page; for service requests, returns a 401 Unauthorized</li><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/exploits/csrf.html target=_blank rel=noopener>Mitigates CSRF</a> attacks</li><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/session-management.html#ns-session-fixation target=_blank rel=noopener>Mitigates Session Fixation</a> attacks</li><li>Writes <a class=link href=https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-hsts target=_blank rel=noopener>Strict-Transport-Security</a> to <a class=link href=https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security target=_blank rel=noopener>ensure HTTPS</a></li><li>Writes <a class=link href=https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-content-type-options target=_blank rel=noopener>X-Content-Type-Options</a> to mitigate <a class=link href=https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-content-type-options target=_blank rel=noopener>sniffing attacks</a></li><li>Writes <a class=link href=https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-cache-control target=_blank rel=noopener>Cache Control headers</a> that protect authenticated resources</li><li>Writes <a class=link href=https://docs.spring.io/spring-security/reference/servlet/exploits/headers.html#servlet-headers-frame-options target=_blank rel=noopener>X-Frame-Options</a> to mitigate <a class=link href=https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-frame-options target=_blank rel=noopener>Clickjacking</a></li><li>Integrates with <a class=link href=https://docs.spring.io/spring-security/reference/servlet/integrations/servlet-api.html target=_blank rel=noopener>HttpServletRequest&rsquo;s authentication methods</a></li><li>Publishes <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/events.html target=_blank rel=noopener>authentication success and failure events</a></li></ul><p><strong>FilterChain</strong>
Spring Security’s Servlet support is based on <strong>Servlet Filters</strong>. The following image shows the typical layering of the handlers for a single HTTP request.
<img src=/filterchain.png loading=lazy>
The client sends a request to the application, and the container creates a FilterChain, which contains the Filter <strong>instances</strong> and Servlet that should process the HttpServletRequest, based on the path of the request URI. In a Spring MVC application, the Servlet is an instance of <a class=link href=https://docs.spring.io/spring-framework/docs/6.1.9/reference/html/web.html#mvc-servlet target=_blank rel=noopener>DispatcherServlet</a>.
At most, one Servlet can handle a single HttpServletRequest and HttpServletResponse.
more than one Filter can be used to:</p><ul><li>Prevent downstream Filter instances or the Servlet from being invoked. In this case, the Filter typically writes the HttpServletResponse.</li><li>Modify the HttpServletRequest or HttpServletResponse used by the downstream Filter instances and the Servlet.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilter</span><span class=p>(</span><span class=n>ServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>ServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> </span><span class=n>FilterChain</span><span class=w> </span><span class=n>chain</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=c1>// do something before the rest of the application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>chain</span><span class=p>.</span><span class=na>doFilter</span><span class=p>(</span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>response</span><span class=p>);</span><span class=w> </span><span class=c1>// invoke the rest of the application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// do something after the rest of the application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>DelegatingFilterProxy</strong>
Spring provides a <strong>Filter implementation</strong> named <a class=link href=https://docs.spring.io/spring-framework/docs/6.1.9/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html target=_blank rel=noopener>DelegatingFilterProxy</a> that allows <strong>bridging</strong> between the Servlet container’s lifecycle and Spring’s ApplicationContext. The Servlet container allows registering Filter instances by using its own standards, but it is not aware of Spring-defined Beans. You can register DelegatingFilterProxy through the standard Servlet container mechanisms but delegate all the work to a Spring Bean that implements Filter.</p><p>Here is a picture of how DelegatingFilterProxy fits into the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filters-review target=_blank rel=noopener>Filter instances and the FilterChain</a>.</p><p><img src=/image%205.png loading=lazy>
DelegatingFilterProxy looks up <em>Bean Filter 0</em> from the ApplicationContext and then invokes <em>Bean Filter0</em>. </p><p><strong>FilterChainProxy</strong>
<a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/SecurityFilterChain.html target=_blank rel=noopener>SecurityFilterChain</a> is used by <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filterchainproxy target=_blank rel=noopener>FilterChainProxy</a> to determine which Spring Security Filter instances should be invoked for the current request.
<img src=/image%206.png loading=lazy>
The <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-security-filters target=_blank rel=noopener>Security Filters</a> in SecurityFilterChain are typically <strong>Beans</strong>, but they are registered with FilterChainProxy instead of <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-delegatingfilterproxy target=_blank rel=noopener>DelegatingFilterProxy</a>. FilterChainProxy provides a number of advantages to registering directly with the Servlet container or <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-delegatingfilterproxy target=_blank rel=noopener>DelegatingFilterProxy</a>. First, it provides a starting point for all of Spring Security’s Servlet support. For that reason</p><p>FilterChainProxy is <strong>central</strong> to Spring Security usage, it can perform tasks that are not viewed as optional. For example, it clears out the SecurityContext to avoid memory leaks. It also applies Spring Security’s <a class=link href=https://docs.spring.io/spring-security/reference/servlet/exploits/firewall.html#servlet-httpfirewall target=_blank rel=noopener>HttpFirewall</a> to protect applications against certain types of attacks.
In addition, it provides more flexibility in determining when a SecurityFilterChain should be invoked. In a Servlet container, Filter instances are invoked based upon the URL alone. However, <strong>FilterChainProxy can determine invocation based upon anything in the HttpServletRequest</strong> by using the RequestMatcher interface.
<img src=/image%207.png loading=lazy>
<strong>Security Filters</strong>
Most of the time, the default security filters are enough to provide security to your application. However, there might be times that you want to add a custom Filter to the security filter chain.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>TenantFilter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Filter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilter</span><span class=p>(</span><span class=n>ServletRequest</span><span class=w> </span><span class=n>servletRequest</span><span class=p>,</span><span class=w> </span><span class=n>ServletResponse</span><span class=w> </span><span class=n>servletResponse</span><span class=p>,</span><span class=w> </span><span class=n>FilterChain</span><span class=w> </span><span class=n>filterChain</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=p>,</span><span class=w> </span><span class=n>ServletException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=p>)</span><span class=w> </span><span class=n>servletRequest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>HttpServletResponse</span><span class=p>)</span><span class=w> </span><span class=n>servletResponse</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>tenantId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>request</span><span class=p>.</span><span class=na>getHeader</span><span class=p>(</span><span class=s>&#34;X-Tenant-Id&#34;</span><span class=p>);</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>boolean</span><span class=w> </span><span class=n>hasAccess</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>isUserAllowed</span><span class=p>(</span><span class=n>tenantId</span><span class=p>);</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>hasAccess</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>filterChain</span><span class=p>.</span><span class=na>doFilter</span><span class=p>(</span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>response</span><span class=p>);</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>AccessDeniedException</span><span class=p>(</span><span class=s>&#34;Access denied&#34;</span><span class=p>);</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecurityConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>SecurityFilterChain</span><span class=w> </span><span class=nf>filterChain</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>csrf</span><span class=p>(</span><span class=n>Customizer</span><span class=p>.</span><span class=na>withDefaults</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>authorizeHttpRequests</span><span class=p>(</span><span class=n>authorize</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>authorize</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>anyRequest</span><span class=p>().</span><span class=na>authenticated</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>httpBasic</span><span class=p>(</span><span class=n>Customizer</span><span class=p>.</span><span class=na>withDefaults</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>formLogin</span><span class=p>(</span><span class=n>Customizer</span><span class=p>.</span><span class=na>withDefaults</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>addFilterBefore</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>TenantFilter</span><span class=p>(),</span><span class=w> </span><span class=n>AuthorizationFilter</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>http</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Be careful when you declare your filter as a Spring bean, either by annotating it with @Component or by declaring it as a bean in your configuration, because Spring Boot will automatically <a class=link href=https://docs.spring.io/spring-boot/docs/3.1.1/reference/html/web.html#web.servlet.embedded-container.servlets-filters-listeners.beans target=_blank rel=noopener>register it with the embedded container</a>. That may cause the filter to be invoked twice, once by the container and once by Spring Security and in a different order.
<strong>Exception Handing</strong>
ExceptionTranslationFilter is inserted into the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filterchainproxy target=_blank rel=noopener>FilterChainProxy</a> as one of the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-security-filters target=_blank rel=noopener>Security Filters</a>.
The <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/access/ExceptionTranslationFilter.html target=_blank rel=noopener>ExceptionTranslationFilter</a> allows translation of <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/access/AccessDeniedException.html target=_blank rel=noopener>AccessDeniedException</a> and <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api//org/springframework/security/core/AuthenticationException.html target=_blank rel=noopener>AuthenticationException</a> into HTTP responses.
<img src=/image%208.png loading=lazy></p><ul><li>If the user is <strong>not authenticated</strong> or it is an AuthenticationException, then <em>Start Authentication</em>.<ul><li>The <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder target=_blank rel=noopener>SecurityContextHolder</a> is cleared out.</li><li>The HttpServletRequest is <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#savedrequests target=_blank rel=noopener>saved</a> so that it can be used to replay the original request once authentication is successful.</li><li>The AuthenticationEntryPoint is used to request credentials from the client. For example, it might redirect to a log in page or send a WWW-Authenticate header.</li></ul></li><li>If it is an AccessDeniedException, then <em>Access Denied</em>. The AccessDeniedHandler is invoked to handle access denied.</li></ul><blockquote><p>If the application does not throw an AccessDeniedException or an AuthenticationException, then ExceptionTranslationFilter does not do anything.</p></blockquote><h3 id=authentication>Authentication</h3><p>At the heart of Spring Security’s <strong>authentication model</strong> is the SecurityContextHolder. It contains the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontext target=_blank rel=noopener>SecurityContext</a>.
<img src=/securitycontextholder.png loading=lazy>
The SecurityContextHolder is where Spring Security stores the details of who is <a class=link href=https://docs.spring.io/spring-security/reference/features/authentication/index.html#authentication target=_blank rel=noopener>authenticated</a>. Spring Security does not care how the SecurityContextHolder is populated. If it contains a value, it is used as the currently authenticated user.</p><p>Get currently authenticated user</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>SecurityContext</span><span class=w> </span><span class=n>context</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SecurityContextHolder</span><span class=p>.</span><span class=na>getContext</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Authentication</span><span class=w> </span><span class=n>authentication</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>context</span><span class=p>.</span><span class=na>getAuthentication</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>authentication</span><span class=p>.</span><span class=na>getName</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Object</span><span class=w> </span><span class=n>principal</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>authentication</span><span class=p>.</span><span class=na>getPrincipal</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Collection</span><span class=o>&lt;?</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>GrantedAuthority</span><span class=o>&gt;</span><span class=w> </span><span class=n>authorities</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>authentication</span><span class=p>.</span><span class=na>getAuthorities</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></div><p>By default, SecurityContextHolder uses a ThreadLocal to store these details, which means that <strong>the SecurityContext is always available to methods in the same thread</strong>, even if the SecurityContext is not explicitly passed around as an argument to those methods.  Using a ThreadLocal in this way is quite safe if you take care to clear the thread after the present principal’s request is processed. Spring Security’s <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-filterchainproxy target=_blank rel=noopener>FilterChainProxy</a> ensures that the SecurityContext is always cleared.
 <strong>Authentication</strong>
⠀The Authentication contains:</p><ul><li><strong>principal</strong>: Identifies the user. When authenticating with a username/password this is often an instance of <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/user-details.html#servlet-authentication-userdetails target=_blank rel=noopener>UserDetails</a>.</li><li><strong>credentials</strong>: Often a password. In many cases, this is cleared after the user is authenticated, to ensure that it is not leaked.</li><li><strong>authorities</strong>: The <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-granted-authority target=_blank rel=noopener>GrantedAuthority</a> instances are high-level permissions the user is granted. Two examples are roles and scopes.</li></ul><p><a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/authentication/AuthenticationManager.html target=_blank rel=noopener>AuthenticationManager</a> is the API that defines <strong>how Spring Security’s Filters perform <a class=link href=**https://docs.spring.io/spring-security/reference/features/authentication/index.html#authentication>authentication</a></strong>. The <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication target=_blank rel=noopener>Authentication</a> that is returned is then set on the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder target=_blank rel=noopener>SecurityContextHolder</a> by the controller (that is, by <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-security-filters target=_blank rel=noopener>Spring Security’s Filters instances</a>) that invoked the AuthenticationManager.
While the implementation of AuthenticationManager could be anything, the most common implementation is <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-providermanager target=_blank rel=noopener>ProviderManager</a>.
<img src=/image%209.png loading=lazy>
ProviderManager delegates to <strong>a List</strong> of <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authenticationprovider target=_blank rel=noopener>AuthenticationProvider</a> instances. Each AuthenticationProvider has an opportunity to indicate that authentication should be successful, fail, or indicate it cannot make a decision and allow a downstream AuthenticationProvider to decide. If none of the configured AuthenticationProvider instances can authenticate, authentication fails with a <strong>ProviderNotFoundException</strong>, which is a special AuthenticationException that indicates that the ProviderManager was not configured to support the type of Authentication that was passed into it.
In practice each AuthenticationProvider knows how to <strong>perform a specific type of authentication</strong>. For example, one AuthenticationProvider might be able to validate a username/password, while another might be able to authenticate a SAML assertion. This lets each AuthenticationProvider do a very specific type of authentication while supporting multiple types of authentication and expose only a single AuthenticationManager bean.
ProviderManager also allows configuring <strong>an optional parent AuthenticationManager</strong>, which is consulted in the event that no AuthenticationProvider can perform authentication. The parent can be any type of AuthenticationManager, but it is often an instance of ProviderManager.
In fact, multiple ProviderManager instances might share the same parent AuthenticationManager. This is somewhat common in scenarios where there are multiple <a class=link href=https://docs.spring.io/spring-security/reference/servlet/architecture.html#servlet-securityfilterchain target=_blank rel=noopener>SecurityFilterChain</a> instances that have some authentication in common (the shared parent AuthenticationManager), but also different authentication mechanisms (the different ProviderManager instances).
<img src=/image%2010.png loading=lazy></p><p>When a client makes an unauthenticated request to a resource that they are not authorized to access. In this case, an implementation of <strong>AuthenticationEntryPoint</strong> is used to request credentials from the client. The AuthenticationEntryPoint implementation might perform a <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html#servlet-authentication-form target=_blank rel=noopener>redirect to a log in page</a>, respond with an <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/basic.html#servlet-authentication-basic target=_blank rel=noopener>WWW-Authenticate</a> header, or take other action.
<strong>AbstractAuthenticationProcessingFilter</strong>
<a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/AbstractAuthenticationProcessingFilter.html target=_blank rel=noopener>AbstractAuthenticationProcessingFilter</a> is used as a base Filter for <strong>authenticating a user’s credentials</strong>.
<img src=/image%2011.png loading=lazy>
When the user submits their credentials, the AbstractAuthenticationProcessingFilter creates an <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication target=_blank rel=noopener>Authentication</a> from the HttpServletRequest to be authenticated. The type of Authentication created depends on the subclass of AbstractAuthenticationProcessingFilter. For example, <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html#servlet-authentication-usernamepasswordauthenticationfilter target=_blank rel=noopener>UsernamePasswordAuthenticationFilter</a> creates a UsernamePasswordAuthenticationToken from a <em>username</em> and <em>password</em> that are submitted in the HttpServletRequest.
Next, the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication target=_blank rel=noopener>Authentication</a> is passed into the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authenticationmanager target=_blank rel=noopener>AuthenticationManager</a> to be authenticated.
If authentication fails, then <em>Failure</em>.</p><ul><li>The <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder target=_blank rel=noopener>SecurityContextHolder</a> is cleared out.</li><li>RememberMeServices.loginFail is invoked. If remember me is not configured, this is a no-op. See the <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/rememberme/package-frame.html target=_blank rel=noopener>rememberme</a> package.</li><li>AuthenticationFailureHandler is invoked. See the <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/AuthenticationFailureHandler.html target=_blank rel=noopener>AuthenticationFailureHandler</a> interface.
If authentication is successful, then <em>Success</em>.</li><li>SessionAuthenticationStrategy is notified of a new login. See the <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/session/SessionAuthenticationStrategy.html target=_blank rel=noopener>SessionAuthenticationStrategy</a> interface.</li><li>The <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication target=_blank rel=noopener>Authentication</a> is set on the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder target=_blank rel=noopener>SecurityContextHolder</a>. Later, if you need to save the SecurityContext so that it can be automatically set on future requests, SecurityContextRepository#saveContext must be explicitly invoked. See the <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextHolderFilter.html target=_blank rel=noopener>SecurityContextHolderFilter</a> class.</li><li>RememberMeServices.loginSuccess is invoked. If remember me is not configured, this is a no-op. See the <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/rememberme/package-frame.html target=_blank rel=noopener>rememberme</a> package.</li><li>ApplicationEventPublisher publishes an InteractiveAuthenticationSuccessEvent.</li><li>AuthenticationSuccessHandler is invoked. See the <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/authentication/AuthenticationSuccessHandler.html target=_blank rel=noopener>AuthenticationSuccessHandler</a> interface.</li></ul><h4 id=usernamepassword-authentication>⠀Username/Password Authentication</h4><p>authenticate users via a REST API </p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecurityConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>SecurityFilterChain</span><span class=w> </span><span class=nf>securityFilterChain</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>authorizeHttpRequests</span><span class=p>((</span><span class=n>authorize</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>authorize</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>requestMatchers</span><span class=p>(</span><span class=s>&#34;/login&#34;</span><span class=p>).</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>anyRequest</span><span class=p>().</span><span class=na>authenticated</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>http</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>AuthenticationManager</span><span class=w> </span><span class=nf>authenticationManager</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=n>UserDetailsService</span><span class=w> </span><span class=n>userDetailsService</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=n>PasswordEncoder</span><span class=w> </span><span class=n>passwordEncoder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>DaoAuthenticationProvider</span><span class=w> </span><span class=n>authenticationProvider</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>DaoAuthenticationProvider</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>authenticationProvider</span><span class=p>.</span><span class=na>setUserDetailsService</span><span class=p>(</span><span class=n>userDetailsService</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>authenticationProvider</span><span class=p>.</span><span class=na>setPasswordEncoder</span><span class=p>(</span><span class=n>passwordEncoder</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ProviderManager</span><span class=p>(</span><span class=n>authenticationProvider</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>UserDetailsService</span><span class=w> </span><span class=nf>userDetailsService</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>UserDetails</span><span class=w> </span><span class=n>userDetails</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>withDefaultPasswordEncoder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>username</span><span class=p>(</span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>password</span><span class=p>(</span><span class=s>&#34;password&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>roles</span><span class=p>(</span><span class=s>&#34;USER&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>InMemoryUserDetailsManager</span><span class=p>(</span><span class=n>userDetails</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>PasswordEncoder</span><span class=w> </span><span class=nf>passwordEncoder</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>PasswordEncoderFactories</span><span class=p>.</span><span class=na>createDelegatingPasswordEncoder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>LoginController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>AuthenticationManager</span><span class=w> </span><span class=n>authenticationManager</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=nf>LoginController</span><span class=p>(</span><span class=n>AuthenticationManager</span><span class=w> </span><span class=n>authenticationManager</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>this</span><span class=p>.</span><span class=na>authenticationManager</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>authenticationManager</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/login&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>Void</span><span class=o>&gt;</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=nd>@RequestBody</span><span class=w> </span><span class=n>LoginRequest</span><span class=w> </span><span class=n>loginRequest</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>Authentication</span><span class=w> </span><span class=n>authenticationRequest</span><span class=w> </span><span class=o>=</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=n>UsernamePasswordAuthenticationToken</span><span class=p>.</span><span class=na>unauthenticated</span><span class=p>(</span><span class=n>loginRequest</span><span class=p>.</span><span class=na>username</span><span class=p>(),</span><span class=w> </span><span class=n>loginRequest</span><span class=p>.</span><span class=na>password</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>Authentication</span><span class=w> </span><span class=n>authenticationResponse</span><span class=w> </span><span class=o>=</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>this</span><span class=p>.</span><span class=na>authenticationManager</span><span class=p>.</span><span class=na>authenticate</span><span class=p>(</span><span class=n>authenticationRequest</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=c1>// ...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kd>record</span> <span class=nc>LoginRequest</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>username</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>password</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Built-in mechanism for reading a username:</p><ul><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html target=_blank rel=noopener>Form</a></li><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/basic.html target=_blank rel=noopener>Basic</a>
WWW-Authenticate header</li><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/digest.html target=_blank rel=noopener>Digest</a>
You should not use Digest Authentication in modern applications, because it is not considered to be secure.</li></ul><p><strong>DaoAuthenticationProvider</strong></p><p><a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/authentication/dao/DaoAuthenticationProvider.html target=_blank rel=noopener>DaoAuthenticationProvider</a> is an <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authenticationprovider target=_blank rel=noopener>AuthenticationProvider</a> implementation that uses a <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/user-details-service.html#servlet-authentication-userdetailsservice target=_blank rel=noopener>UserDetailsService</a> and <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/password-encoder.html#servlet-authentication-password-storage target=_blank rel=noopener>PasswordEncoder</a> to authenticate a username and password.
<img src=/image%2012.png loading=lazy></p><h4 id=persistence><strong>Persistence</strong></h4><p>in Spring Security the association of the user to future requests is made using <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextRepository.html target=_blank rel=noopener>SecurityContextRepository</a>. The default implementation of SecurityContextRepository is <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/DelegatingSecurityContextRepository.html target=_blank rel=noopener>DelegatingSecurityContextRepository</a> which delegates to the following:</p><ul><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#httpsecuritycontextrepository target=_blank rel=noopener>HttpSessionSecurityContextRepository</a></li><li><a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#requestattributesecuritycontextrepository target=_blank rel=noopener>RequestAttributeSecurityContextRepository</a></li></ul><p><strong>NullSecurityContextRepository</strong>
If it is not desirable to associate the SecurityContext to an HttpSession (i.e. when authenticating with OAuth) the <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/NullSecurityContextRepository.html target=_blank rel=noopener>NullSecurityContextRepository</a> is an implementation of SecurityContextRepository that does nothing.</p><p>The<a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextPersistenceFilter.html target=_blank rel=noopener>SecurityContextPersistenceFilter</a> is responsible for persisting the SecurityContext between requests using the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#securitycontextrepository target=_blank rel=noopener>SecurityContextRepository</a>.
<img src=/image%2013.png loading=lazy>
<strong>SecurityContextHolderFilter</strong>
The <a class=link href=https://docs.spring.io/spring-security/site/docs/6.3.1/api/org/springframework/security/web/context/SecurityContextHolderFilter.html target=_blank rel=noopener>SecurityContextHolderFilter</a> is responsible for loading the SecurityContext between requests using the <a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#securitycontextrepository target=_blank rel=noopener>SecurityContextRepository</a>.
<img src=/image%2014.png loading=lazy>
Unlike,<a class=link href=https://docs.spring.io/spring-security/reference/servlet/authentication/persistence.html#securitycontextpersistencefilter target=_blank rel=noopener>SecurityContextPersistenceFilter</a>, SecurityContextHolderFilter only loads the SecurityContext it does not save the SecurityContext. This means that when using SecurityContextHolderFilter, it is required that the SecurityContext is explicitly saved.</p><h2 id=restful-api>Restful API</h2><p>@RestController</p><p>@Service</p><p>@Reposity</p></section><footer class=article-footer><section class=article-tags><a href=/tags/spring-boot/>Spring Boot</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Jul 02, 2024 00:00 UTC</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/spring-bootuploaded-image-processing/><div class=article-details><h2 class=article-title>【Spring Boot】Uploaded Image Processing</h2></div></a></article><article class=has-image><a href=/p/many-one-relationship/><div class=article-image><img src=/covers/cover19.png loading=lazy data-key data-hash=/covers/cover19.png></div><div class=article-details><h2 class=article-title>Many-One Relationship</h2></div></a></article><article class=has-image><a href=/p/one-one-relationship/><div class=article-image><img src=/covers/cover21.jpg loading=lazy data-key data-hash=/covers/cover21.jpg></div><div class=article-details><h2 class=article-title>One-One Relationship</h2></div></a></article><article class=has-image><a href=/p/many-many-relationship/><div class=article-image><img src=/covers/cover20.jpg loading=lazy data-key data-hash=/covers/cover20.jpg></div><div class=article-details><h2 class=article-title>Many-Many Relationship</h2></div></a></article><article><a href=/p/databaseschema/><div class=article-details><h2 class=article-title>【Database】Schema</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 飞鸿踏雪泥</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>